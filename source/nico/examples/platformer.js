/* Generated by the Nim Compiler v0.17.0 */
/*   (c) 2017 Andreas Rumpf */

var framePtr = null;
var excHandler = 0;
var lastJSError = null;
if (typeof Int8Array === 'undefined') Int8Array = Array;
if (typeof Int16Array === 'undefined') Int16Array = Array;
if (typeof Int32Array === 'undefined') Int32Array = Array;
if (typeof Uint8Array === 'undefined') Uint8Array = Array;
if (typeof Uint16Array === 'undefined') Uint16Array = Array;
if (typeof Uint32Array === 'undefined') Uint32Array = Array;
if (typeof Float32Array === 'undefined') Float32Array = Array;
if (typeof Float64Array === 'undefined') Float64Array = Array;
var NTI184084 = {size: 0, kind: 17, base: null, node: null, finalizer: null};
var NTI184066 = {size: 0, kind: 17, base: null, node: null, finalizer: null};
var NTI184087 = {size: 0, kind: 17, base: null, node: null, finalizer: null};
var NTI3482 = {size: 0, kind: 17, base: null, node: null, finalizer: null};
var NTI3454 = {size: 0, kind: 17, base: null, node: null, finalizer: null};
var NTI184091 = {size: 0, kind: 17, base: null, node: null, finalizer: null};
var NTI184077 = {size: 0, kind: 17, base: null, node: null, finalizer: null};
var NTI184071 = {size: 0, kind: 17, base: null, node: null, finalizer: null};
var NTI184073 = {size: 0, kind: 17, base: null, node: null, finalizer: null};
var NTI184009 = {size: 0, kind: 14, base: null, node: null, finalizer: null};
var NTI184007 = {size: 0, kind: 14, base: null, node: null, finalizer: null};
var NTI184048 = {size: 0, kind: 17, base: null, node: null, finalizer: null};
var NTI184003 = {size: 0, kind: 18, base: null, node: null, finalizer: null};
var NTI126 = {size: 0,kind: 37,base: null,node: null,finalizer: null};
var NTI183017 = {size: 0, kind: 18, base: null, node: null, finalizer: null};
var NTI183025 = {size: 0, kind: 18, base: null, node: null, finalizer: null};
var NTI184032 = {size: 0, kind: 17, base: null, node: null, finalizer: null};
var NTI184005 = {size: 0,kind: 22,base: null,node: null,finalizer: null};
var NTI187281 = {size: 0,kind: 24,base: null,node: null,finalizer: null};
var NTI33247 = {size: 0,kind: 24,base: null,node: null,finalizer: null};
var NTI33246 = {size: 0, kind: 17, base: null, node: null, finalizer: null};
var NTI3462 = {size: 0, kind: 17, base: null, node: null, finalizer: null};
var NTI33206 = {size: 0, kind: 18, base: null, node: null, finalizer: null};
var NTI180084 = {size: 0,kind: 24,base: null,node: null,finalizer: null};
var NTI34224 = {size: 0,kind: 24,base: null,node: null,finalizer: null};
var NTI57018 = {size: 0,kind: 24,base: null,node: null,finalizer: null};
var NTI116 = {size: 0,kind: 41,base: null,node: null,finalizer: null};
var NTI33408 = {size: 0, kind: 18, base: null, node: null, finalizer: null};
var NTI3426 = {size: 0, kind: 17, base: null, node: null, finalizer: null};
var NTI3428 = {size: 0, kind: 17, base: null, node: null, finalizer: null};
var NTI25244 = {size: 0,kind: 16,base: null,node: null,finalizer: null};
var NTI124 = {size: 0,kind: 36,base: null,node: null,finalizer: null};
var NTI25237 = {size: 0, kind: 18, base: null, node: null, finalizer: null};
var NTI25240 = {size: 0,kind: 16,base: null,node: null,finalizer: null};
var NTI25202 = {size: 0, kind: 14, base: null, node: null, finalizer: null};
var NTI25231 = {size: 0, kind: 17, base: null, node: null, finalizer: null};
var NTI25230 = {size: 0,kind: 22,base: null,node: null,finalizer: null};
var NTI163227 = {size: 0,kind: 24,base: null,node: null,finalizer: null};
var NTI162040 = {size: 0,kind: 24,base: null,node: null,finalizer: null};
var NTI162026 = {size: 0,kind: 16,base: null,node: null,finalizer: null};
var NTI161051 = {size: 0, kind: 17, base: null, node: null, finalizer: null};
var NTI161024 = {size: 0,kind: 22,base: null,node: null,finalizer: null};
var NTI130 = {size: 0,kind: 1,base: null,node: null,finalizer: null};
var NTI104 = {size: 0,kind: 31,base: null,node: null,finalizer: null};
var NTI33204 = {size: 0,kind: 20,base: null,node: null,finalizer: null};
var NTI3440 = {size: 0, kind: 17, base: null, node: null, finalizer: null};
var NTI3408 = {size: 0, kind: 17, base: null, node: null, finalizer: null};
var NTI138 = {size: 0,kind: 28,base: null,node: null,finalizer: null};
var NTI140 = {size: 0,kind: 29,base: null,node: null,finalizer: null};
var NTI3487 = {size: 0,kind: 22,base: null,node: null,finalizer: null};
var NTI3424 = {size: 0, kind: 17, base: null, node: null, finalizer: null};
var NTI3438 = {size: 0, kind: 17, base: null, node: null, finalizer: null};
var NTI3442 = {size: 0, kind: 17, base: null, node: null, finalizer: null};
var NNI3442 = {kind: 2, len: 0, offset: 0, typ: null, name: null, sons: []};
NTI3442.node = NNI3442;
var NNI3438 = {kind: 2, len: 0, offset: 0, typ: null, name: null, sons: []};
NTI3438.node = NNI3438;
NTI3487.base = NTI3424;
var NNI3424 = {kind: 2, len: 4, offset: 0, typ: null, name: null, sons: [{kind: 1, offset: "parent", len: 0, typ: NTI3487, name: "parent", sons: null}, 
{kind: 1, offset: "name", len: 0, typ: NTI140, name: "name", sons: null}, 
{kind: 1, offset: "message", len: 0, typ: NTI138, name: "msg", sons: null}, 
{kind: 1, offset: "trace", len: 0, typ: NTI138, name: "trace", sons: null}]};
NTI3424.node = NNI3424;
var NNI3408 = {kind: 2, len: 0, offset: 0, typ: null, name: null, sons: []};
NTI3408.node = NNI3408;
NTI3424.base = NTI3408;
NTI3438.base = NTI3424;
NTI3442.base = NTI3438;
var NNI3440 = {kind: 2, len: 0, offset: 0, typ: null, name: null, sons: []};
NTI3440.node = NNI3440;
NTI3440.base = NTI3438;
NTI33204.base = NTI104;
var NNI161051 = {kind: 2, len: 0, offset: 0, typ: null, name: null, sons: []};
NTI161051.node = NNI161051;
NTI161051.base = NTI3408;
NTI161024.base = NTI161051;
NTI162040.base = NTI104;
NTI162026.base = NTI162040;
var NNI25202 = {kind: 2, offset: 0, typ: null, name: null, len: 2, sons: {"0": {kind: 1, offset: 0, typ: NTI25202, name: "Keyboard", len: 0, sons: null}, 
"1": {kind: 1, offset: 1, typ: NTI25202, name: "Gamepad", len: 0, sons: null}}};
NTI25202.node = NNI25202;
var NNI25237 = {kind: 2, len: 2, offset: 0, typ: null, name: null, sons: [{kind: 1, offset: "Field0", len: 0, typ: NTI124, name: "Field0", sons: null}, 
{kind: 1, offset: "Field1", len: 0, typ: NTI124, name: "Field1", sons: null}]};
NTI25237.node = NNI25237;
NTI25240.base = NTI25237;
NTI25244.base = NTI104;
var NNI25231 = {kind: 2, len: 9, offset: 0, typ: null, name: null, sons: [{kind: 1, offset: "kind", len: 0, typ: NTI25202, name: "kind", sons: null}, 
{kind: 1, offset: "name", len: 0, typ: NTI138, name: "name", sons: null}, 
{kind: 1, offset: "id", len: 0, typ: NTI104, name: "id", sons: null}, 
{kind: 1, offset: "axes", len: 0, typ: NTI25240, name: "axes", sons: null}, 
{kind: 1, offset: "buttons", len: 0, typ: NTI25244, name: "buttons", sons: null}, 
{kind: 1, offset: "deadzone", len: 0, typ: NTI124, name: "deadzone", sons: null}, 
{kind: 1, offset: "invertX", len: 0, typ: NTI130, name: "invertX", sons: null}, 
{kind: 1, offset: "invertY", len: 0, typ: NTI130, name: "invertY", sons: null}, 
{kind: 1, offset: "useRightStick", len: 0, typ: NTI130, name: "useRightStick", sons: null}]};
NTI25231.node = NNI25231;
NTI25230.base = NTI25231;
NTI163227.base = NTI25230;
var NNI3428 = {kind: 2, len: 0, offset: 0, typ: null, name: null, sons: []};
NTI3428.node = NNI3428;
var NNI3426 = {kind: 2, len: 0, offset: 0, typ: null, name: null, sons: []};
NTI3426.node = NNI3426;
NTI3426.base = NTI3424;
NTI3428.base = NTI3426;
var NNI33408 = {kind: 2, len: 3, offset: 0, typ: null, name: null, sons: [{kind: 1, offset: "Field0", len: 0, typ: NTI116, name: "Field0", sons: null}, 
{kind: 1, offset: "Field1", len: 0, typ: NTI116, name: "Field1", sons: null}, 
{kind: 1, offset: "Field2", len: 0, typ: NTI116, name: "Field2", sons: null}]};
NTI33408.node = NNI33408;
NTI57018.base = NTI116;
NTI34224.base = NTI116;
var NNI33206 = {kind: 2, len: 4, offset: 0, typ: null, name: null, sons: [{kind: 1, offset: "Field0", len: 0, typ: NTI104, name: "Field0", sons: null}, 
{kind: 1, offset: "Field1", len: 0, typ: NTI104, name: "Field1", sons: null}, 
{kind: 1, offset: "Field2", len: 0, typ: NTI104, name: "Field2", sons: null}, 
{kind: 1, offset: "Field3", len: 0, typ: NTI104, name: "Field3", sons: null}]};
NTI33206.node = NNI33206;
NTI180084.base = NTI33206;
var NNI3462 = {kind: 2, len: 0, offset: 0, typ: null, name: null, sons: []};
NTI3462.node = NNI3462;
NTI3462.base = NTI3424;
NTI33247.base = NTI116;
var NNI33246 = {kind: 2, len: 4, offset: 0, typ: null, name: null, sons: [{kind: 1, offset: "data", len: 0, typ: NTI33247, name: "data", sons: null}, 
{kind: 1, offset: "channels", len: 0, typ: NTI104, name: "channels", sons: null}, 
{kind: 1, offset: "w", len: 0, typ: NTI104, name: "w", sons: null}, 
{kind: 1, offset: "h", len: 0, typ: NTI104, name: "h", sons: null}]};
NTI33246.node = NNI33246;
var NNI183025 = {kind: 2, len: 2, offset: 0, typ: null, name: null, sons: [{kind: 1, offset: "Field0", len: 0, typ: NTI104, name: "Field0", sons: null}, 
{kind: 1, offset: "Field1", len: 0, typ: NTI104, name: "Field1", sons: null}]};
NTI183025.node = NNI183025;
var NNI183017 = {kind: 2, len: 2, offset: 0, typ: null, name: null, sons: [{kind: 1, offset: "Field0", len: 0, typ: NTI126, name: "Field0", sons: null}, 
{kind: 1, offset: "Field1", len: 0, typ: NTI126, name: "Field1", sons: null}]};
NTI183017.node = NNI183017;
var NNI184003 = {kind: 2, len: 4, offset: 0, typ: null, name: null, sons: [{kind: 1, offset: "Field0", len: 0, typ: NTI104, name: "Field0", sons: null}, 
{kind: 1, offset: "Field1", len: 0, typ: NTI104, name: "Field1", sons: null}, 
{kind: 1, offset: "Field2", len: 0, typ: NTI104, name: "Field2", sons: null}, 
{kind: 1, offset: "Field3", len: 0, typ: NTI104, name: "Field3", sons: null}]};
NTI184003.node = NNI184003;
var NNI184032 = {kind: 2, len: 8, offset: 0, typ: null, name: null, sons: [{kind: 1, offset: "pos", len: 0, typ: NTI183025, name: "pos", sons: null}, 
{kind: 1, offset: "vel", len: 0, typ: NTI183017, name: "vel", sons: null}, 
{kind: 1, offset: "rem", len: 0, typ: NTI183017, name: "rem", sons: null}, 
{kind: 1, offset: "hitbox", len: 0, typ: NTI184003, name: "hitbox", sons: null}, 
{kind: 1, offset: "shouldKill", len: 0, typ: NTI130, name: "shouldKill", sons: null}, 
{kind: 1, offset: "bounciness", len: 0, typ: NTI124, name: "bounciness", sons: null}, 
{kind: 1, offset: "ethereal", len: 0, typ: NTI130, name: "ethereal", sons: null}, 
{kind: 1, offset: "riding", len: 0, typ: NTI184005, name: "riding", sons: null}]};
NTI184032.node = NNI184032;
NTI184032.base = NTI3408;
NTI184005.base = NTI184032;
NTI187281.base = NTI184005;
var NNI184007 = {kind: 2, offset: 0, typ: null, name: null, len: 2, sons: {"0": {kind: 1, offset: 0, typ: NTI184007, name: "Human", len: 0, sons: null}, 
"1": {kind: 1, offset: 1, typ: NTI184007, name: "Plane", len: 0, sons: null}}};
NTI184007.node = NNI184007;
var NNI184009 = {kind: 2, offset: 0, typ: null, name: null, len: 4, sons: {"0": {kind: 1, offset: 0, typ: NTI184009, name: "Machinegun", len: 0, sons: null}, 
"1": {kind: 1, offset: 1, typ: NTI184009, name: "Shotgun", len: 0, sons: null}, 
"2": {kind: 1, offset: 2, typ: NTI184009, name: "Burst", len: 0, sons: null}, 
"3": {kind: 1, offset: 3, typ: NTI184009, name: "Noppy", len: 0, sons: null}}};
NTI184009.node = NNI184009;
var NNI184048 = {kind: 2, len: 16, offset: 0, typ: null, name: null, sons: [{kind: 1, offset: "mode", len: 0, typ: NTI184007, name: "mode", sons: null}, 
{kind: 1, offset: "weapon", len: 0, typ: NTI184009, name: "weapon", sons: null}, 
{kind: 1, offset: "wasOnGround", len: 0, typ: NTI130, name: "wasOnGround", sons: null}, 
{kind: 1, offset: "wasOnWall", len: 0, typ: NTI130, name: "wasOnWall", sons: null}, 
{kind: 1, offset: "jump", len: 0, typ: NTI130, name: "jump", sons: null}, 
{kind: 1, offset: "jbuffer", len: 0, typ: NTI104, name: "jbuffer", sons: null}, 
{kind: 1, offset: "grace", len: 0, typ: NTI104, name: "grace", sons: null}, 
{kind: 1, offset: "dir", len: 0, typ: NTI104, name: "dir", sons: null}, 
{kind: 1, offset: "step", len: 0, typ: NTI104, name: "step", sons: null}, 
{kind: 1, offset: "ammo", len: 0, typ: NTI104, name: "ammo", sons: null}, 
{kind: 1, offset: "firing", len: 0, typ: NTI130, name: "firing", sons: null}, 
{kind: 1, offset: "score", len: 0, typ: NTI104, name: "score", sons: null}, 
{kind: 1, offset: "hp", len: 0, typ: NTI104, name: "hp", sons: null}, 
{kind: 1, offset: "hitflash", len: 0, typ: NTI104, name: "hitflash", sons: null}, 
{kind: 1, offset: "combo", len: 0, typ: NTI104, name: "combo", sons: null}, 
{kind: 1, offset: "bulletTimer", len: 0, typ: NTI104, name: "bulletTimer", sons: null}]};
NTI184048.node = NNI184048;
NTI184048.base = NTI184032;
var NNI184073 = {kind: 2, len: 2, offset: 0, typ: null, name: null, sons: [{kind: 1, offset: "hp", len: 0, typ: NTI104, name: "hp", sons: null}, 
{kind: 1, offset: "hitflash", len: 0, typ: NTI104, name: "hitflash", sons: null}]};
NTI184073.node = NNI184073;
var NNI184071 = {kind: 2, len: 0, offset: 0, typ: null, name: null, sons: []};
NTI184071.node = NNI184071;
NTI184071.base = NTI184032;
NTI184073.base = NTI184071;
var NNI184077 = {kind: 1, offset: "direction", len: 0, typ: NTI104, name: "direction", sons: null};
NTI184077.node = NNI184077;
NTI184077.base = NTI184071;
var NNI184091 = {kind: 2, len: 3, offset: 0, typ: null, name: null, sons: [{kind: 1, offset: "hp", len: 0, typ: NTI104, name: "hp", sons: null}, 
{kind: 1, offset: "hitflash", len: 0, typ: NTI104, name: "hitflash", sons: null}, 
{kind: 1, offset: "target", len: 0, typ: NTI184005, name: "target", sons: null}]};
NTI184091.node = NNI184091;
NTI184091.base = NTI184032;
var NNI3454 = {kind: 2, len: 0, offset: 0, typ: null, name: null, sons: []};
NTI3454.node = NNI3454;
NTI3454.base = NTI3424;
var NNI3482 = {kind: 2, len: 0, offset: 0, typ: null, name: null, sons: []};
NTI3482.node = NNI3482;
NTI3482.base = NTI3426;
var NNI184087 = {kind: 2, len: 2, offset: 0, typ: null, name: null, sons: [{kind: 1, offset: "size", len: 0, typ: NTI104, name: "size", sons: null}, 
{kind: 1, offset: "ttl", len: 0, typ: NTI104, name: "ttl", sons: null}]};
NTI184087.node = NNI184087;
NTI184087.base = NTI184032;
var NNI184066 = {kind: 2, len: 3, offset: 0, typ: null, name: null, sons: [{kind: 1, offset: "damage", len: 0, typ: NTI104, name: "damage", sons: null}, 
{kind: 1, offset: "destructive", len: 0, typ: NTI130, name: "destructive", sons: null}, 
{kind: 1, offset: "ttl", len: 0, typ: NTI104, name: "ttl", sons: null}]};
NTI184066.node = NNI184066;
NTI184066.base = NTI184032;
var NNI184084 = {kind: 1, offset: "ttl", len: 0, typ: NTI104, name: "ttl", sons: null};
NTI184084.node = NNI184084;
NTI184084.base = NTI184032;
function makeNimstrLit(c_14003) {

    var ln = c_14003.length;
    var result = new Array(ln + 1);
    var i = 0;
    for (; i < ln; ++i) {
      result[i] = c_14003.charCodeAt(i);
    }
    result[i] = 0; // terminating zero
    return result;
    }
function setConstr() {

      var result = {};
      for (var i = 0; i < arguments.length; ++i) {
        var x = arguments[i];
        if (typeof(x) == "object") {
          for (var j = x[0]; j <= x[1]; ++j) {
            result[j] = true;
          }
        } else {
          result[x] = true;
        }
      }
      return result;
    }
var ConstSet1 = setConstr(17, 16, 4, 18, 27, 19, 23, 22, 21);
function nimCopy(dest_19217, src_19218, ti_19219) {

var result_19629 = null;
switch (ti_19219.kind) {
case 21: case 22: case 23: case 5: if (!(isFatPointer_19201(ti_19219))) {
result_19629 = src_19218;
}
else {
result_19629 = [src_19218[0], src_19218[1]];}


break;
case 19:       if (dest_19217 === null || dest_19217 === undefined) {
        dest_19217 = {};
      }
      else {
        for (var key in dest_19217) { delete dest_19217[key]; }
      }
      for (var key in src_19218) { dest_19217[key] = src_19218[key]; }
      result_19629 = dest_19217;
    
break;
case 18: case 17: if (!((ti_19219.base == null))) {
result_19629 = nimCopy(dest_19217, src_19218, ti_19219.base);
}
else {
if ((ti_19219.kind == 17)) {
result_19629 = (dest_19217 === null || dest_19217 === undefined) ? {m_type: ti_19219} : dest_19217;}
else {
result_19629 = (dest_19217 === null || dest_19217 === undefined) ? {} : dest_19217;}
}
nimCopyAux(result_19629, src_19218, ti_19219.node);

break;
case 24: case 4: case 27: case 16:       if (src_19218 === null) {
        result_19629 = null;
      }
      else {
        if (dest_19217 === null || dest_19217 === undefined) {
          dest_19217 = new Array(src_19218.length);
        }
        else {
          dest_19217.length = src_19218.length;
        }
        result_19629 = dest_19217;
        for (var i = 0; i < src_19218.length; ++i) {
          result_19629[i] = nimCopy(result_19629[i], src_19218[i], ti_19219.base);
        }
      }
    
break;
case 28:       if (src_19218 !== null) {
        result_19629 = src_19218.slice(0);
      }
    
break;
default: 
result_19629 = src_19218;
break;
}
return result_19629;
}
function eqStrings(a_16603, b_16604) {

    if (a_16603 == b_16604) return true;
    if ((!a_16603) || (!b_16604)) return false;
    var alen = a_16603.length;
    if (alen != b_16604.length) return false;
    for (var i = 0; i < alen; ++i)
      if (a_16603[i] != b_16604[i]) return false;
    return true;
  }
function toJSStr(s_14403) {

    var len = s_14403.length-1;
    var asciiPart = new Array(len);
    var fcc = String.fromCharCode;
    var nonAsciiPart = null;
    var nonAsciiOffset = 0;
    for (var i = 0; i < len; ++i) {
      if (nonAsciiPart !== null) {
        var offset = (i - nonAsciiOffset) * 2;
        var code = s_14403[i].toString(16);
        if (code.length == 1) {
          code = "0"+code;
        }
        nonAsciiPart[offset] = "%";
        nonAsciiPart[offset + 1] = code;
      }
      else if (s_14403[i] < 128)
        asciiPart[i] = fcc(s_14403[i]);
      else {
        asciiPart.length = i;
        nonAsciiOffset = i;
        nonAsciiPart = new Array((len - i) * 2);
        --i;
      }
    }
    asciiPart = asciiPart.join("");
    return (nonAsciiPart === null) ?
        asciiPart : asciiPart + decodeURIComponent(nonAsciiPart.join(""));
  }
function raiseException(e_13406, ename_13407) {

e_13406.name = ename_13407;
if ((excHandler == 0)) {
unhandledException(e_13406);
}

throw e_13406;}
function arrayConstr(len_19664, value_19665, typ_19666) {

      var result = new Array(len_19664);
      for (var i = 0; i < len_19664; ++i) result[i] = nimCopy(null, value_19665, typ_19666);
      return result;
    }
function rawEcho() {

var node_16636 = null;
node_16636 = document.getElementsByTagName('body')[0];if ((node_16636 === null)) {
var e_16650 = null;
e_16650 = {m_type: NTI3428, parent: null, name: null, message: null, trace: null};
e_16650.message = nimCopy(null, makeNimstrLit("<body> element does not exist yet!"), NTI138);
e_16650.parent = null;
raiseException(e_16650, "IOError");
}

    for (var i = 0; i < arguments.length; ++i) {
      var x = toJSStr(arguments[i]);
      node_16636.appendChild(document.createTextNode(x));
    }
    node_16636.appendChild(document.createElement("br"));
    }
function cstrToNimstr(c_14203) {

  var ln = c_14203.length;
  var result = new Array(ln);
  var r = 0;
  for (var i = 0; i < ln; ++i) {
    var ch = c_14203.charCodeAt(i);

    if (ch < 128) {
      result[r] = ch;
    }
    else if((ch > 127) && (ch < 2048)) {
      result[r] = (ch >> 6) | 192;
      ++r;
      result[r] = (ch & 63) | 128;
    }
    else {
      result[r] = (ch >> 12) | 224;
      ++r;
      result[r] = ((ch >> 6) & 63) | 128;
      ++r;
      result[r] = (ch & 63) | 128;
    }
    ++r;
  }
  result[r] = 0; // terminating zero
  return result;
  }
function reprEnum(e_20228, typ_20229) {

var result_20230 = null;
if (!(isUndefined_20232(typ_20229.node.sons[e_20228]))) {
result_20230 = nimCopy(null, cstrToNimstr(typ_20229.node.sons[e_20228].name), NTI138);
}
else {
result_20230 = nimCopy(null, (cstrToNimstr((e_20228)+"").slice(0,-1)).concat(makeNimstrLit(" (invalid data!)")), NTI138);
}

return result_20230;
}
function isObj(obj_19868, subclass_19869) {

var result_19870 = false;
BeforeRet: do {
var x_19871 = obj_19868;
if ((x_19871 == subclass_19869)) {
result_19870 = true;
break BeforeRet;
}

L1: do {
L2: while (true) {
if (!!((x_19871 == subclass_19869))) break L2;
if ((x_19871 == null)) {
result_19870 = false;
break BeforeRet;
}

x_19871 = x_19871.base;
}
} while(false);
result_19870 = true;
break BeforeRet;
} while (false); 
return result_19870;
}
function reraiseException() {

if ((lastJSError == null)) {
var e_13820 = null;
e_13820 = {m_type: NTI3462, parent: null, name: null, message: null, trace: null};
e_13820.message = nimCopy(null, makeNimstrLit("no exception to reraise"), NTI138);
e_13820.parent = null;
raiseException(e_13820, "ReraiseError");
}
else {
if ((excHandler == 0)) {
if (isNimException_12653()) {
unhandledException(lastJSError);
}

}

throw lastJSError;}

}
function mnewString(len_14603) {

      var result = new Array(len_14603+1);
      result[0] = 0;
      result[len_14603] = 0;
      return result;
    }
function nimCharToStr(x_12651) {

var result_12652 = null;
result_12652 = nimCopy(null, mnewString(1), NTI138);
result_12652[0] = x_12651;
return result_12652;
}
function nimMin(a_18839, b_18840) {

var Tmp1;
var result_18841 = 0;
BeforeRet: do {
if ((a_18839 <= b_18840)) {
Tmp1 = a_18839;
}
else {
Tmp1 = b_18840;
}

result_18841 = Tmp1;
break BeforeRet;
} while (false); 
return result_18841;
}
function nimMax(a_18844, b_18845) {

var Tmp1;
var result_18846 = 0;
BeforeRet: do {
if ((b_18845 <= a_18844)) {
Tmp1 = a_18844;
}
else {
Tmp1 = b_18845;
}

result_18846 = Tmp1;
break BeforeRet;
} while (false); 
return result_18846;
}
var nimvm_5887 = false;
var nim_program_result = 0;
var globalRaiseHook_11005 = [null];
var localRaiseHook_11010 = [null];
var outOfMemHook_11013 = [null];
function isFatPointer_19201(ti_19203) {

var result_19204 = false;
BeforeRet: do {
result_19204 = !((ConstSet1[ti_19203.base.kind] != undefined));
break BeforeRet;
} while (false); 
return result_19204;
}
function nimCopyAux(dest_19222, src_19223, n_19225) {

switch (n_19225.kind) {
case 0: 
break;
case 1:       dest_19222[n_19225.offset] = nimCopy(dest_19222[n_19225.offset], src_19223[n_19225.offset], n_19225.typ);
    
break;
case 2: L1: do {
var i_19615 = 0;
var colontmp__19617 = 0;
colontmp__19617 = (n_19225.len - 1);
var res_19620 = 0;
L2: do {
L3: while (true) {
if (!(res_19620 <= colontmp__19617)) break L3;
i_19615 = res_19620;
nimCopyAux(dest_19222, src_19223, n_19225.sons[i_19615]);
res_19620 += 1;
}
} while(false);
} while(false);

break;
case 3:       dest_19222[n_19225.offset] = nimCopy(dest_19222[n_19225.offset], src_19223[n_19225.offset], n_19225.typ);
      for (var i = 0; i < n_19225.sons.length; ++i) {
        nimCopyAux(dest_19222, src_19223, n_19225.sons[i][1]);
      }
    
break;
}
}
function add_11029(x_11032, x_11032_Idx, y_11033) {

        var len = x_11032[0].length-1;
        for (var i = 0; i < y_11033.length; ++i) {
          x_11032[0][len] = y_11033.charCodeAt(i);
          ++len;
        }
        x_11032[0][len] = 0
      }
function unhandledException(e_13253) {

var Tmp1;
var buf_13254 = /**/[makeNimstrLit("")];
if (!!(eqStrings(e_13253.message, null))) Tmp1 = false; else {Tmp1 = !((e_13253.message[0] == 0)); }if (Tmp1) {
if (buf_13254[0] != null) { buf_13254[0] = (buf_13254[0].slice(0, -1)).concat(makeNimstrLit("Error: unhandled exception: ")); } else { buf_13254[0] = makeNimstrLit("Error: unhandled exception: ");};
if (buf_13254[0] != null) { buf_13254[0] = (buf_13254[0].slice(0, -1)).concat(e_13253.message); } else { buf_13254[0] = e_13253.message;};
}
else {
if (buf_13254[0] != null) { buf_13254[0] = (buf_13254[0].slice(0, -1)).concat(makeNimstrLit("Error: unhandled exception")); } else { buf_13254[0] = makeNimstrLit("Error: unhandled exception");};
}

if (buf_13254[0] != null) { buf_13254[0] = (buf_13254[0].slice(0, -1)).concat(makeNimstrLit(" [")); } else { buf_13254[0] = makeNimstrLit(" [");};
add_11029(buf_13254, 0, e_13253.name);
if (buf_13254[0] != null) { buf_13254[0] = (buf_13254[0].slice(0, -1)).concat(makeNimstrLit("]\x0A")); } else { buf_13254[0] = makeNimstrLit("]\x0A");};
var cbuf_13401 = toJSStr(buf_13254[0]);
framePtr = null;
  if (typeof(Error) !== "undefined") {
    throw new Error(cbuf_13401);
  }
  else {
    throw cbuf_13401;
  }
  }
function raiseOverflow() {

var e_13840 = null;
e_13840 = {m_type: NTI3442, parent: null, name: null, message: null, trace: null};
e_13840.message = nimCopy(null, makeNimstrLit("over- or underflow"), NTI138);
e_13840.parent = null;
raiseException(e_13840, "OverflowError");
}
function raiseDivByZero() {

var e_13858 = null;
e_13858 = {m_type: NTI3440, parent: null, name: null, message: null, trace: null};
e_13858.message = nimCopy(null, makeNimstrLit("division by zero"), NTI138);
e_13858.parent = null;
raiseException(e_13858, "DivByZeroError");
}
var initialized_33310 = [false];
var running_33312 = [false];
var loading_33314 = [0];
var swCanvas_33316 = [{data: null, channels: 0, w: 0, h: 0}];
var targetScreenWidth_33319 = /**/[128];
var targetScreenHeight_33321 = /**/[128];
var fixedScreenSize_33322 = /**/[true];
var integerScreenScale_33323 = /**/[false];
var screenWidth_33325 = /**/[128];
var screenHeight_33327 = /**/[128];
var screenPaddingX_33328 = /**/[0];
var screenPaddingY_33329 = /**/[0];
var keymap_33334 = [[null, null, null, null, null, null, null, null, null, null, null, null, null, null]];
var controllerAddedFunc_33339 = [null];
var controllerRemovedFunc_33344 = [null];
var controllers_33347 = [null];
var focused_33349 = /**/[true];
var recordSeconds_33351 = /**/[30];
var fullSpeedGif_33352 = /**/[true];
var currentTilemap_33353 = [{data: null, w: 0, h: 0}];
var spriteFlags_33358 = [new Uint8Array(128)];
var mixerChannels_33360 = /**/[0];
var frameRate_33362 = /**/[60];
function slash__21007(x_21009, y_21010) {

var result_21011 = 0.0;
result_21011 = (x_21009 / y_21010);
return result_21011;
}
var timeStep_33363 = /**/[slash__21007(1, frameRate_33362[0])];
var frameMult_33364 = /**/[1];
var basePath_33365 = [null];
var assetPath_33367 = [null];
var writePath_33369 = [null];
var screenScale_33371 = /**/[4.0000000000000000e+000];
var spriteSheets_33375 = [[{data: null, channels: 0, w: 0, h: 0}, {data: null, channels: 0, w: 0, h: 0}, {data: null, channels: 0, w: 0, h: 0}, {data: null, channels: 0, w: 0, h: 0}, {data: null, channels: 0, w: 0, h: 0}, {data: null, channels: 0, w: 0, h: 0}, {data: null, channels: 0, w: 0, h: 0}, {data: null, channels: 0, w: 0, h: 0}, {data: null, channels: 0, w: 0, h: 0}, {data: null, channels: 0, w: 0, h: 0}, {data: null, channels: 0, w: 0, h: 0}, {data: null, channels: 0, w: 0, h: 0}, {data: null, channels: 0, w: 0, h: 0}, {data: null, channels: 0, w: 0, h: 0}, {data: null, channels: 0, w: 0, h: 0}, {data: null, channels: 0, w: 0, h: 0}]];
var spriteSheet_33378 = [null];
var initFunc_33382 = [null];
var updateFunc_33386 = [null];
var drawFunc_33390 = [null];
var textFunc_33394 = [null];
var resizeFunc_33397 = [null];
var fonts_33402 = [[null, null, null, null]];
var currentFontId_33404 = [0];
var frame_33406 = /**/[0];
var colors_33418 = [[{Field0: 0, Field1: 0, Field2: 0}, {Field0: 0, Field1: 0, Field2: 0}, {Field0: 0, Field1: 0, Field2: 0}, {Field0: 0, Field1: 0, Field2: 0}, {Field0: 0, Field1: 0, Field2: 0}, {Field0: 0, Field1: 0, Field2: 0}, {Field0: 0, Field1: 0, Field2: 0}, {Field0: 0, Field1: 0, Field2: 0}, {Field0: 0, Field1: 0, Field2: 0}, {Field0: 0, Field1: 0, Field2: 0}, {Field0: 0, Field1: 0, Field2: 0}, {Field0: 0, Field1: 0, Field2: 0}, {Field0: 0, Field1: 0, Field2: 0}, {Field0: 0, Field1: 0, Field2: 0}, {Field0: 0, Field1: 0, Field2: 0}, {Field0: 0, Field1: 0, Field2: 0}]];
var cameraX_33420 = /**/[0];
var cameraY_33422 = /**/[0];
var paletteSize_33425 = /**/[16];
var paletteMapDraw_33430 = [arrayConstr(256, 0, NTI33204)];
var paletteMapDisplay_33435 = [arrayConstr(256, 0, NTI33204)];
var paletteTransparent_33440 = [arrayConstr(256, false, NTI130)];
var Tmp5;
L2: do {
var i_33451 = [0];
var colontmp__33454 = 0;
colontmp__33454 = paletteSize_33425[0];
var i_33457 = 0;
L3: do {
L4: while (true) {
if (!(i_33457 < colontmp__33454)) break L4;
i_33451[0] = i_33457;
paletteMapDraw_33430[0][i_33451[0]] = i_33451[0];
paletteMapDisplay_33435[0][i_33451[0]] = i_33451[0];
if ((i_33451[0] == 0)) {
Tmp5 = true;
}
else {
Tmp5 = false;
}

paletteTransparent_33440[0][i_33451[0]] = Tmp5;
i_33457 += 1;
}
} while(false);
} while(false);
var currentColor_33459 = /**/[0];
var keepRunning_33461 = /**/[true];
var muteAudio_33462 = /**/[false];
var currentMusicId_33463 = /**/[-1];
var clipMinX_33465 = [0];
var clipMaxX_33466 = [0];
var clipMinY_33467 = [0];
var clipMaxY_33468 = [0];
var clippingRect_33473 = [{Field0: 0, Field1: 0, Field2: 0, Field3: 0}];
var mouseDetected_33475 = [false];
var mouseX_33477 = [0];
var mouseY_33478 = [0];
var mouseButtonsDown_33483 = [[false, false, false]];
var mouseButtons_33487 = [new Int32Array(3)];
var mouseWheelState_33489 = [0];
var objectID_58232 = /**/[0];
var ctx_162001 = [null];
var swCanvas32_162003 = [null];
var canvas_162005 = [null];
var interval_162008 = [null];
var audioContext_162010 = [null];
var sfxData_162014 = [arrayConstr(64, null, NTI161024)];
var musicData_162018 = [arrayConstr(64, null, NTI161024)];
var currentMusic_162020 = /**/[null];
var sfxGain_162022 = [null];
var musicGain_162023 = [null];
nimCopy(keymap_33334[0], [[38, 87], [40, 83], [37, 65], [39, 68], [90, 89], [88], [16], [67], [70], [71], [86], [66], [13], [27, 8]], NTI162026);
function mute() {

if (!((musicGain_162023[0].gain.value == 0.0))) {
musicGain_162023[0].gain.value = 0.0;
sfxGain_162022[0].gain.value = 0.0;
}
else {
musicGain_162023[0].gain.value = 1.0000000000000000e+000;
sfxGain_162022[0].gain.value = 1.0000000000000000e+000;
}

}
var state_168605 = /**/[{a0: 1773455756, a1: 4275166512}];
function getTime_171041() {

var result_173013 = null;
BeforeRet: do {
result_173013 = new Date();
break BeforeRet;
} while (false); 
return result_173013;
}
var startMilsecs_173112 = /**/[getTime_171041()];
clipMaxX_33466[0] = (screenWidth_33325[0] - 1);
clipMaxY_33468[0] = (screenHeight_33327[0] - 1);
var frame_184001 = /**/[0];
var player_184159 = [null];
var gameOver_184161 = [false];
var cx_185412 = /**/[0.0];
var cy_185413 = /**/[0.0];
var objects_185415 = [null];
function newSeq_163222(len_163226) {

var result_163228 = null;
result_163228 = new Array(len_163226); for (var i=0;i<len_163226;++i) {result_163228[i]=null;}return result_163228;
}
function new_25277() {

var result_25282 = null;
BeforeRet: do {
var r_25401 = null;
r_25401 = {kind: 0, name: null, id: 0, axes: [{Field0: 0.0, Field1: 0.0}, {Field0: 0.0, Field1: 0.0}, {Field0: 0.0, Field1: 0.0}, {Field0: 0.0, Field1: 0.0}, {Field0: 0.0, Field1: 0.0}, {Field0: 0.0, Field1: 0.0}], buttons: new Int32Array(14), deadzone: 0.0, invertX: false, invertY: false, useRightStick: false};
result_25282 = r_25401;
break BeforeRet;
} while (false); 
return result_25282;
}
function isUndefined_20232(x_20236) {

var result_20237 = false;
result_20237 = x_20236 === undefined;return result_20237;
}
function newNicoController_25271(id_25273) {

var result_25274 = null;
result_25274 = new_25277();
result_25274.id = (id_25273|0);
if ((-1 < id_25273)) {
result_25274.kind = 1;
result_25274.deadzone = 5.0000000000000000e-001;
}
else {
result_25274.kind = 0;
result_25274.name = nimCopy(null, makeNimstrLit("KEYBOARD"), NTI138);
}

rawEcho(makeNimstrLit("added game controller: "), cstrToNimstr(((id_25273|0))+""), makeNimstrLit(": "), reprEnum(result_25274.kind, NTI25202), makeNimstrLit(": "), result_25274.name);
return result_25274;
}
function init_163205(org_163207, app_163208) {

basePath_33365[0] = nimCopy(null, makeNimstrLit(""), NTI138);
assetPath_33367[0] = nimCopy(null, makeNimstrLit("assets/"), NTI138);
writePath_33369[0] = nimCopy(null, makeNimstrLit(""), NTI138);
controllers_33347[0] = nimCopy(null, newSeq_163222(0), NTI163227);
if (controllers_33347[0] != null) { controllers_33347[0].push(newNicoController_25271(-1)); } else { controllers_33347[0] = [newNicoController_25271(-1)]; };
}
function RGB_34828(r_34830, g_34831, b_34832) {

var result_34833 = {Field0: 0, Field1: 0, Field2: 0};
BeforeRet: do {
nimCopy(result_34833, {Field0: r_34830, Field1: g_34831, Field2: b_34832}, NTI33408);
break BeforeRet;
} while (false); 
return result_34833;
}
function loadPalettePico8_177246() {

nimCopy(colors_33418[0][0], RGB_34828(0, 0, 0), NTI33408);
nimCopy(colors_33418[0][1], RGB_34828(29, 43, 83), NTI33408);
nimCopy(colors_33418[0][2], RGB_34828(126, 37, 83), NTI33408);
nimCopy(colors_33418[0][3], RGB_34828(0, 135, 81), NTI33408);
nimCopy(colors_33418[0][4], RGB_34828(171, 82, 54), NTI33408);
nimCopy(colors_33418[0][5], RGB_34828(95, 87, 79), NTI33408);
nimCopy(colors_33418[0][6], RGB_34828(194, 195, 199), NTI33408);
nimCopy(colors_33418[0][7], RGB_34828(255, 241, 232), NTI33408);
nimCopy(colors_33418[0][8], RGB_34828(255, 0, 77), NTI33408);
nimCopy(colors_33418[0][9], RGB_34828(255, 163, 0), NTI33408);
nimCopy(colors_33418[0][10], RGB_34828(255, 240, 36), NTI33408);
nimCopy(colors_33418[0][11], RGB_34828(0, 231, 86), NTI33408);
nimCopy(colors_33418[0][12], RGB_34828(41, 173, 255), NTI33408);
nimCopy(colors_33418[0][13], RGB_34828(131, 118, 156), NTI33408);
nimCopy(colors_33418[0][14], RGB_34828(255, 119, 168), NTI33408);
nimCopy(colors_33418[0][15], RGB_34828(255, 204, 170), NTI33408);
}
function setSpritesheet_181094(bank_181097) {

spriteSheet_33378[0] = spriteSheets_33375[0][bank_181097];
}
function rotl_168802(x_168804, k_168805) {

var result_168806 = 0;
result_168806 = ((x_168804 << k_168805) | ((x_168804 >>> 0) >>> ((64 - k_168805) >>> 0)));
return result_168806;
}
function next_168841(s_168844) {

var result_168845 = 0;
var s0_168846 = s_168844.a0;
var s1_168847 = s_168844.a1;
result_168845 = ((s0_168846 + s1_168847) >>> 0);
s1_168847 = (s1_168847 ^ s0_168846);
s_168844.a0 = ((rotl_168802(s0_168846, 55) ^ s1_168847) ^ (s1_168847 << 14));
s_168844.a1 = rotl_168802(s1_168847, 36);
return result_168845;
}
function randomize_169427(seed_169429) {

state_168605[0].a0 = ((seed_169429 >>> 0) >>> 16);
state_168605[0].a1 = (seed_169429 & 65535);
next_168841(state_168605[0]);
}
function randomize_174001() {

randomize_169427(getTime_171041().getTime());
}
function setFont_177203(fontId_177205) {

BeforeRet: do {
if ((4 < fontId_177205)) {
break BeforeRet;
}

currentFontId_33404[0] = fontId_177205;
} while (false); 
}
function getContext2D_57513(c_57515) {

var result_57516 = null;
result_57516=c_57515.getContext('2d');return result_57516;
}
function loadSurface_162743(filename_162745, callback_162749) {

function colonanonymous__162760(event_162762) {

loading_33314[0] -= 1;
var target_162772 = event_162762.target;
console.log("image loaded: ", target_162772.src);
var canvas_162781 = document.createElement("canvas");
var ctx_162782 = getContext2D_57513(canvas_162781);
var w_162783 = target_162772.width;
var h_162784 = target_162772.height;
canvas_162781.width = w_162783;
canvas_162781.height = h_162784;
ctx_162782.drawImage(target_162772, 0.0, 0.0);
var imgData_162785 = ctx_162782.getImageData(0.0, 0.0, w_162783, h_162784);
var surface_162786 = {data: null, channels: 0, w: 0, h: 0};
surface_162786.w = w_162783;
surface_162786.h = h_162784;
surface_162786.channels = 4;
surface_162786.data = nimCopy(null, imgData_162785.data, NTI57018);
callback_162749(surface_162786);
}
loading_33314[0] += 1;
var img_162759 = document.createElement("img");
img_162759.addEventListener("load", colonanonymous__162760, false);
img_162759.src = toJSStr(filename_162745);
}
function new_179823() {

var result_179828 = null;
BeforeRet: do {
var r_180001 = null;
r_180001 = {rects: null, data: null, w: 0, h: 0};
result_179828 = r_180001;
break BeforeRet;
} while (false); 
return result_179828;
}
function newSeq_34219(len_34223) {

var result_34225 = null;
result_34225 = new Array(len_34223); for (var i=0;i<len_34223;++i) {result_34225[i]=0;}return result_34225;
}
function newSeq_180079(len_180083) {

var result_180085 = null;
result_180085 = new Array(len_180083); for (var i=0;i<len_180083;++i) {result_180085[i]={Field0: 0, Field1: 0, Field2: 0, Field3: 0};}return result_180085;
}
function createFontFromSurface_179816(surface_179818, chars_179819) {

var result_179820 = null;
BeforeRet: do {
var font_180010 = new_179823();
font_180010.w = surface_179818.w;
font_180010.h = surface_179818.h;
font_180010.data = nimCopy(null, newSeq_34219((font_180010.w * font_180010.h)), NTI34224);
L1: do {
var i_180046 = 0;
var colontmp__180158 = 0;
colontmp__180158 = (font_180010.w * font_180010.h);
var i_180161 = 0;
L2: do {
L3: while (true) {
if (!(i_180161 < colontmp__180158)) break L3;
i_180046 = i_180161;
if ((surface_179818.data[((i_180046 * 4) + 3)] == 0)) {
font_180010.data[i_180046] = 0;
}
else {
if ((0 < surface_179818.data[((i_180046 * 4) + 0)])) {
font_180010.data[i_180046] = 2;
}
else {
font_180010.data[i_180046] = 1;
}
}
i_180161 += 1;
}
} while(false);
} while(false);
var highestChar_180063 = 0;
L4: do {
var c_180065 = 0;
var i_180167 = 0;
var L_180169 = (chars_179819 != null ? chars_179819.length-1 : 0);
L5: do {
L6: while (true) {
if (!(i_180167 < L_180169)) break L6;
c_180065 = chars_179819[i_180167];
if ((highestChar_180063 < c_180065)) {
highestChar_180063 = c_180065;
}

i_180167 += 1;
}
} while(false);
} while(false);
font_180010.rects = nimCopy(null, newSeq_180079(((highestChar_180063|0) + 1)), NTI180084);
var newChar_180103 = false;
var blankColor_180104 = font_180010.data[0];
var currentRect_180106 = {Field0: 0, Field1: 0, Field2: 0, Field3: 0};
var i_180107 = 0;
L7: do {
var x_180117 = 0;
var colontmp__180180 = 0;
colontmp__180180 = font_180010.w;
var i_180183 = 0;
L8: do {
L9: while (true) {
if (!(i_180183 < colontmp__180180)) break L9;
x_180117 = i_180183;
var color_180118 = font_180010.data[x_180117];
if ((color_180118 == blankColor_180104)) {
currentRect_180106.Field2 = (x_180117 - currentRect_180106.Field0);
if (!((currentRect_180106.Field2 == 0))) {
currentRect_180106.Field3 = (font_180010.h - 1);
L10: do {
var y_180136 = 0;
var colontmp__180174 = 0;
colontmp__180174 = font_180010.h;
var i_180177 = 0;
L11: do {
L12: while (true) {
if (!(i_180177 < colontmp__180174)) break L12;
y_180136 = i_180177;
var color_180137 = font_180010.data[((y_180136 * font_180010.w) + x_180117)];
if ((color_180137 == blankColor_180104)) {
currentRect_180106.Field3 = (y_180136 - 2);
}

i_180177 += 1;
}
} while(false);
} while(false);
var charId_180146 = (chars_179819[i_180107]|0);
nimCopy(font_180010.rects[charId_180146], currentRect_180106, NTI33206);
i_180107 += 1;
}

newChar_180103 = true;
currentRect_180106.Field0 = (x_180117 + 1);
}

i_180183 += 1;
}
} while(false);
} while(false);
result_179820 = font_180010;
break BeforeRet;
} while (false); 
return result_179820;
}
function loadFont_180185(filename_180187, chars_180188) {

function colonanonymous__180189(surface_180191) {

fonts_33402[0][currentFontId_33404[0]] = createFontFromSurface_179816(surface_180191, chars_180188);
console.log("font created from ", toJSStr(filename_180187));
}
loadSurface_162743((assetPath_33367[0].slice(0,-1)).concat(filename_180187), colonanonymous__180189);
}
function isNimException_12653() {

return lastJSError.m_type;}
function loadConfig_163203() {

}
function clip_177268() {

clipMinX_33465[0] = 0;
clipMaxX_33466[0] = (screenWidth_33325[0] - 1);
clipMinY_33467[0] = 0;
clipMaxY_33468[0] = (screenHeight_33327[0] - 1);
clippingRect_33473[0].Field0 = 0;
clippingRect_33473[0].Field1 = 0;
clippingRect_33473[0].Field2 = (screenWidth_33325[0] - 1);
clippingRect_33473[0].Field3 = (screenHeight_33327[0] - 1);
}
function init_177436(org_177438, app_177439) {

var Tmp2;
controllers_33347[0] = nimCopy(null, newSeq_163222(0), NTI163227);
init_163205(org_177438, app_177439);
loadPalettePico8_177246();
setSpritesheet_181094(0);
initialized_33310[0] = true;
randomize_174001();
setFont_177203(0);
++excHandler;
Tmp2 = framePtr;
try {
loadFont_180185(makeNimstrLit("font.png"), makeNimstrLit(" !\"#$%&\'()*+,-./0123456789:;<=>?@abcdefghijklmnopqrstuvwxyz[\\]^_`ABCDEFGHIJKLMNOPQRSTUVWXYZ{:}~"));
--excHandler;
} catch (EXC) {
 var prevJSError = lastJSError;
 lastJSError = EXC;
 --excHandler;
framePtr = Tmp2;
if (lastJSError && (isObj(lastJSError.m_type, NTI3428))) {
}
else {
reraiseException();
}
lastJSError = prevJSError;
} finally {
framePtr = Tmp2;
}
loadConfig_163203();
clip_177268();
}
init_177436(makeNimstrLit("nico"), makeNimstrLit("platformer"));
function resize_163258() {

}
function seqToPtr_180809(x_180814) {

return x_180814}
function eqeq__180526(x_180531, y_180534) {

var result_180535 = false;
BeforeRet: do {
if ((seqToPtr_180809(x_180531) == seqToPtr_180809(y_180534))) {
result_180535 = true;
break BeforeRet;
}

if (((x_180531 === null) || (y_180534 === null))) {
result_180535 = false;
break BeforeRet;
}

if (!(((x_180531 != null ? x_180531.length : 0) == (y_180534 != null ? y_180534.length : 0)))) {
result_180535 = false;
break BeforeRet;
}

L1: do {
var i_181045 = 0;
var colontmp__181055 = 0;
colontmp__181055 = ((x_180531 != null ? x_180531.length : 0) - 1);
var res_181058 = 0;
L2: do {
L3: while (true) {
if (!(res_181058 <= colontmp__181055)) break L3;
i_181045 = res_181058;
if (!((x_180531[i_181045] == y_180534[i_181045]))) {
result_180535 = false;
break BeforeRet;
}

res_181058 += 1;
}
} while(false);
} while(false);
result_180535 = true;
break BeforeRet;
} while (false); 
return result_180535;
}
function psetRaw_177492(x_177494, y_177495, c_177496) {

swCanvas_33316[0].data[((y_177495 * swCanvas_33316[0].w) + x_177494)] = c_177496;
}
function cls_177888() {

L1: do {
var y_177899 = 0;
var res_177920 = clipMinY_33467[0];
L2: do {
L3: while (true) {
if (!(res_177920 <= clipMaxY_33468[0])) break L3;
y_177899 = res_177920;
L4: do {
var x_177909 = 0;
var res_177914 = clipMinX_33465[0];
L5: do {
L6: while (true) {
if (!(res_177914 <= clipMaxX_33466[0])) break L6;
x_177909 = res_177914;
psetRaw_177492(x_177909, y_177899, 0);
res_177914 += 1;
}
} while(false);
} while(false);
res_177920 += 1;
}
} while(false);
} while(false);
}
function present_162213() {

L1: do {
var i_162247 = 0;
var v_162248 = 0;
var colontmp__162251 = null;
colontmp__162251 = swCanvas_33316[0].data;
var i_162254 = 0;
L2: do {
L3: while (true) {
if (!(i_162254 < (colontmp__162251 != null ? colontmp__162251.length : 0))) break L3;
i_162247 = i_162254;
v_162248 = colontmp__162251[i_162254];
swCanvas32_162003[0].data[(i_162247 * 4)] = colors_33418[0][v_162248]["Field0"];
swCanvas32_162003[0].data[((i_162247 * 4) + 1)] = colors_33418[0][v_162248]["Field1"];
swCanvas32_162003[0].data[((i_162247 * 4) + 2)] = colors_33418[0][v_162248]["Field2"];
swCanvas32_162003[0].data[((i_162247 * 4) + 3)] = 255;
i_162254 += 1;
}
} while(false);
} while(false);
ctx_162001[0].putImageData(swCanvas32_162003[0], 0.0, 0.0);
}
function resize_181062() {

resize_163258();
clip_177268();
if (!(eqeq__180526(swCanvas_33316[0].data, null))) {
cls_177888();
present_162213();
}

}
function fixedSize_181085(enabled_181087) {

fixedScreenSize_33322[0] = enabled_181087;
resize_181062();
}
fixedSize_181085(true);
function integerScale_181091(enabled_181093) {

integerScreenScale_33323[0] = enabled_181093;
resize_181062();
}
integerScale_181091(true);
function newSurface_34201(w_34203, h_34204) {

var result_34205 = {data: null, channels: 0, w: 0, h: 0};
result_34205.data = nimCopy(null, newSeq_34219((w_34203 * h_34204)), NTI34224);
result_34205.w = w_34203;
result_34205.h = h_34204;
return result_34205;
}
function setButtonState_26116(self_26118, button_26119, down_26120) {

var Tmp1;
BeforeRet: do {
if ((13 < button_26119)) {
break BeforeRet;
}

if (down_26120) {
Tmp1 = 1;
}
else {
Tmp1 = 0;
}

self_26118.buttons[button_26119] = Tmp1;
} while (false); 
}
function createWindow_162257(title_162259, w_162260, h_162261, scale_162262, fullscreen_162263) {

function colonanonymous__162264(e_162266) {

mouseDetected_33475[0] = true;
var scale_162267 = (canvas_162005[0].clientWidth / screenWidth_33325[0]);
mouseX_33477[0] = ((e_162266.offsetX / scale_162267)|0);
mouseY_33478[0] = ((e_162266.offsetY / scale_162267)|0);
}
function colonanonymous__162274(e_162276) {

mouseButtonsDown_33483[0][e_162276.button] = true;
e_162276.preventDefault();
}
function colonanonymous__162277(e_162279) {

mouseButtonsDown_33483[0][e_162279.button] = false;
e_162279.preventDefault();
}
function colonanonymous__162280(e_162282) {

e_162282.preventDefault();
}
function colonanonymous__162283(e_162285) {

var e_162286 = e_162285;
mouseButtonsDown_33483[0][0] = true;
var scale_162287 = (canvas_162005[0].clientWidth / screenWidth_33325[0]);
mouseX_33477[0] = (((e_162286.touches.item(0).pageX - e_162286.target.offsetLeft) / scale_162287)|0);
mouseY_33478[0] = (((e_162286.touches.item(0).pageY - e_162286.target.offsetTop) / scale_162287)|0);
e_162286.preventDefault();
}
function colonanonymous__162294(e_162296) {

var e_162297 = e_162296;
var scale_162298 = (canvas_162005[0].clientWidth / screenWidth_33325[0]);
mouseX_33477[0] = (((e_162297.touches.item(0).pageX - e_162297.target.offsetLeft) / scale_162298)|0);
mouseY_33478[0] = (((e_162297.touches.item(0).pageY - e_162297.target.offsetTop) / scale_162298)|0);
e_162297.preventDefault();
}
function colonanonymous__162305(e_162307) {

mouseButtonsDown_33483[0][0] = false;
e_162307.preventDefault();
}
function colonanonymous__162320(event_162322) {

L1: do {
var btn_162371 = 0;
var keys_162372 = null;
var i_162612 = 0;
if ((i_162612 <= 13)) {
L2: do {
L3: while (true) {
if (!true) break L3;
btn_162371 = i_162612;
keys_162372 = keymap_33334[0][i_162612];
L4: do {
var key_162602 = 0;
var i_162607 = 0;
var L_162609 = (keys_162372 != null ? keys_162372.length : 0);
L5: do {
L6: while (true) {
if (!(i_162607 < L_162609)) break L6;
key_162602 = keys_162372[i_162607];
if ((event_162322.keyCode == key_162602)) {
setButtonState_26116(controllers_33347[0][0], btn_162371, true);
event_162322.preventDefault();
}

i_162607 += 1;
}
} while(false);
} while(false);
if ((13 <= i_162612)) {
break L2;
}

i_162612 += 1;
}
} while(false);
}

} while(false);
}
function colonanonymous__162613(event_162615) {

L1: do {
var btn_162630 = 0;
var keys_162631 = null;
var i_162650 = 0;
if ((i_162650 <= 13)) {
L2: do {
L3: while (true) {
if (!true) break L3;
btn_162630 = i_162650;
keys_162631 = keymap_33334[0][i_162650];
L4: do {
var key_162640 = 0;
var i_162645 = 0;
var L_162647 = (keys_162631 != null ? keys_162631.length : 0);
L5: do {
L6: while (true) {
if (!(i_162645 < L_162647)) break L6;
key_162640 = keys_162631[i_162645];
if ((event_162615.keyCode == key_162640)) {
setButtonState_26116(controllers_33347[0][0], btn_162630, false);
event_162615.preventDefault();
}

i_162645 += 1;
}
} while(false);
} while(false);
if ((13 <= i_162650)) {
break L2;
}

i_162650 += 1;
}
} while(false);
}

} while(false);
}
nimCopy(swCanvas_33316[0], newSurface_34201(w_162260, h_162261), NTI33246);
screenWidth_33325[0] = w_162260;
screenHeight_33327[0] = h_162261;
canvas_162005[0] = document.createElement("canvas");
canvas_162005[0].width = w_162260;
canvas_162005[0].height = h_162261;
canvas_162005[0].style.width = toJSStr((cstrToNimstr(((w_162260 * scale_162262))+"").slice(0,-1)).concat(makeNimstrLit("px")));
canvas_162005[0].style.height = toJSStr((cstrToNimstr(((h_162261 * scale_162262))+"").slice(0,-1)).concat(makeNimstrLit("px")));
canvas_162005[0].style.cursor = "none";
canvas_162005[0].onmousemove = colonanonymous__162264;
canvas_162005[0].onmousedown = colonanonymous__162274;
canvas_162005[0].onmouseup = colonanonymous__162277;
canvas_162005[0].addEventListener("contextmenu", colonanonymous__162280, false);
canvas_162005[0].addEventListener("touchstart", colonanonymous__162283, false);
canvas_162005[0].addEventListener("touchmove", colonanonymous__162294, false);
canvas_162005[0].addEventListener("touchend", colonanonymous__162305, false);
var holder_162308 = document.getElementById("nicogame");
if (!((holder_162308 == null))) {
holder_162308.appendChild(canvas_162005[0]);
}

ctx_162001[0] = getContext2D_57513(canvas_162005[0]);
swCanvas32_162003[0] = ctx_162001[0].getImageData(0.0, 0.0, w_162260, h_162261);
frame_33406[0] = 0;
window.onkeydown = colonanonymous__162320;
window.onkeyup = colonanonymous__162613;
}
function createWindow_181672(title_181674, w_181675, h_181676, scale_181677, fullscreen_181678) {

createWindow_162257(title_181674, w_181675, h_181676, scale_181677, fullscreen_181678);
}
createWindow_181672(makeNimstrLit("platformer"), 128, 128, 4, false);
function update_25610(self_25612) {

L1: do {
var i_25814 = 0;
var res_25869 = 0;
L2: do {
L3: while (true) {
if (!(res_25869 <= 13)) break L3;
i_25814 = res_25869;
if ((self_25612.kind == 1)) {
if ((i_25814 == 9)) {
if ((self_25612.deadzone < self_25612.axes[4].Field0)) {
self_25612.buttons[i_25814] += 1;
}
else {
self_25612.buttons[i_25814] = 0;
}

}
else {
if ((i_25814 == 11)) {
if ((self_25612.deadzone < self_25612.axes[5].Field0)) {
self_25612.buttons[i_25814] += 1;
}
else {
self_25612.buttons[i_25814] = 0;
}

}
}
}

if ((1 <= self_25612.buttons[i_25814])) {
self_25612.buttons[i_25814] += 1;
}

res_25869 += 1;
}
} while(false);
} while(false);
}
function step_162796() {

BeforeRet: do {
if ((0 < loading_33314[0])) {
console.log("loading...", loading_33314[0]);
L1: do {
var i_162822 = 0;
var v_162823 = 0;
var colontmp__163047 = null;
colontmp__163047 = swCanvas_33316[0].data;
var i_163050 = 0;
L2: do {
L3: while (true) {
if (!(i_163050 < (colontmp__163047 != null ? colontmp__163047.length : 0))) break L3;
i_162822 = i_163050;
v_162823 = colontmp__163047[i_163050];
swCanvas32_162003[0].data[(i_162822 * 4)] = colors_33418[0][v_162823]["Field0"];
swCanvas32_162003[0].data[((i_162822 * 4) + 1)] = colors_33418[0][v_162823]["Field1"];
swCanvas32_162003[0].data[((i_162822 * 4) + 2)] = colors_33418[0][v_162823]["Field2"];
swCanvas32_162003[0].data[((i_162822 * 4) + 3)] = 255;
i_163050 += 1;
}
} while(false);
} while(false);
ctx_162001[0].putImageData(swCanvas32_162003[0], 0.0, 0.0);
frame_33406[0] += 1;
break BeforeRet;
}

L4: do {
var i_162866 = 0;
var b_162867 = false;
var i_163056 = 0;
if ((i_163056 <= 2)) {
L5: do {
L6: while (true) {
if (!true) break L6;
i_162866 = i_163056;
b_162867 = mouseButtonsDown_33483[0][i_163056];
if (b_162867) {
mouseButtons_33487[0][i_162866] += 1;
}
else {
mouseButtons_33487[0][i_162866] = 0;
}

if ((2 <= i_163056)) {
break L5;
}

i_163056 += 1;
}
} while(false);
}

} while(false);
L7: do {
var controller_163002 = null;
var i_163060 = 0;
var L_163062 = (controllers_33347[0] != null ? controllers_33347[0].length : 0);
L8: do {
L9: while (true) {
if (!(i_163060 < L_163062)) break L9;
controller_163002 = controllers_33347[0][i_163060];
update_25610(controller_163002);
i_163060 += 1;
}
} while(false);
} while(false);
if (!((updateFunc_33386[0] == null))) {
updateFunc_33386[0](1.6666666666666666e-002);
}

if (!((drawFunc_33390[0] == null))) {
drawFunc_33390[0]();
}

L10: do {
var i_163033 = 0;
var v_163034 = 0;
var colontmp__163064 = null;
colontmp__163064 = swCanvas_33316[0].data;
var i_163067 = 0;
L11: do {
L12: while (true) {
if (!(i_163067 < (colontmp__163064 != null ? colontmp__163064.length : 0))) break L12;
i_163033 = i_163067;
v_163034 = colontmp__163064[i_163067];
swCanvas32_162003[0].data[(i_163033 * 4)] = colors_33418[0][v_163034]["Field0"];
swCanvas32_162003[0].data[((i_163033 * 4) + 1)] = colors_33418[0][v_163034]["Field1"];
swCanvas32_162003[0].data[((i_163033 * 4) + 2)] = colors_33418[0][v_163034]["Field2"];
swCanvas32_162003[0].data[((i_163033 * 4) + 3)] = 255;
i_163067 += 1;
}
} while(false);
} while(false);
ctx_162001[0].putImageData(swCanvas32_162003[0], 0.0, 0.0);
frame_33406[0] += 1;
} while (false); 
}
function run_163421() {

if (!((interval_162008[0] == null))) {
window.clearInterval(interval_162008[0]);
}

interval_162008[0] = window.setInterval(step_162796, 16);
}
function run_181760(init_181764, update_181768, draw_181771) {

initFunc_33382[0] = init_181764;
updateFunc_33386[0] = update_181768;
drawFunc_33390[0] = draw_181771;
if (!((initFunc_33382[0] == null))) {
initFunc_33382[0]();
}

if (!(running_33312[0])) {
running_33312[0] = true;
run_163421();
}

}
function loadPaletteCGA_177248() {

nimCopy(colors_33418[0][0], RGB_34828(0, 0, 0), NTI33408);
nimCopy(colors_33418[0][1], RGB_34828(85, 255, 255), NTI33408);
nimCopy(colors_33418[0][2], RGB_34828(255, 85, 255), NTI33408);
nimCopy(colors_33418[0][3], RGB_34828(255, 255, 255), NTI33408);
nimCopy(colors_33418[0][4], RGB_34828(0, 0, 0), NTI33408);
nimCopy(colors_33418[0][5], RGB_34828(0, 0, 0), NTI33408);
nimCopy(colors_33418[0][6], RGB_34828(0, 0, 0), NTI33408);
nimCopy(colors_33418[0][7], RGB_34828(0, 0, 0), NTI33408);
nimCopy(colors_33418[0][8], RGB_34828(0, 0, 0), NTI33408);
nimCopy(colors_33418[0][9], RGB_34828(0, 0, 0), NTI33408);
nimCopy(colors_33418[0][10], RGB_34828(0, 0, 0), NTI33408);
nimCopy(colors_33418[0][11], RGB_34828(0, 0, 0), NTI33408);
nimCopy(colors_33418[0][12], RGB_34828(0, 0, 0), NTI33408);
nimCopy(colors_33418[0][13], RGB_34828(0, 0, 0), NTI33408);
nimCopy(colors_33418[0][14], RGB_34828(0, 0, 0), NTI33408);
nimCopy(colors_33418[0][15], RGB_34828(0, 0, 0), NTI33408);
}
function mapRGB_34698(r_34700, g_34701, b_34702) {

var result_34703 = 0;
BeforeRet: do {
L1: do {
var i_34736 = 0;
var v_34737 = {Field0: 0, Field1: 0, Field2: 0};
var i_34765 = 0;
if ((i_34765 <= 15)) {
L2: do {
L3: while (true) {
if (!true) break L3;
i_34736 = i_34765;
v_34737 = colors_33418[0][i_34765];
if ((((v_34737["Field0"] == r_34700) && (v_34737["Field1"] == g_34701)) && (v_34737["Field2"] == b_34702))) {
result_34703 = i_34736;
break BeforeRet;
}

if ((15 <= i_34765)) {
break L2;
}

i_34765 += 1;
}
} while(false);
}

} while(false);
result_34703 = 0;
break BeforeRet;
} while (false); 
return result_34703;
}
function convertToIndexed_34766(surface_34768) {

var result_34769 = {data: null, channels: 0, w: 0, h: 0};
if (!((surface_34768.channels == 4))) {
var e_34776 = null;
e_34776 = {m_type: NTI3424, parent: null, name: null, message: null, trace: null};
e_34776.message = nimCopy(null, makeNimstrLit("Converting non RGBA surface to indexed"), NTI138);
e_34776.parent = null;
raiseException(e_34776, "Exception");
}

result_34769.data = nimCopy(null, newSeq_34219((surface_34768.w * surface_34768.h)), NTI34224);
result_34769.w = surface_34768.w;
result_34769.h = surface_34768.h;
result_34769.channels = 1;
L1: do {
var i_34820 = 0;
var colontmp__34823 = 0;
colontmp__34823 = (surface_34768.w * surface_34768.h);
var i_34826 = 0;
L2: do {
L3: while (true) {
if (!(i_34826 < colontmp__34823)) break L3;
i_34820 = i_34826;
result_34769.data[i_34820] = mapRGB_34698(surface_34768.data[((i_34820 * 4) + 0)], surface_34768.data[((i_34820 * 4) + 1)], surface_34768.data[((i_34820 * 4) + 2)]);
i_34826 += 1;
}
} while(false);
} while(false);
return result_34769;
}
function loadSpriteSheet_181099(filename_181101) {

function colonanonymous__181102(surface_181104) {

nimCopy(spriteSheet_33378[0], convertToIndexed_34766(surface_181104), NTI33246);
}
loadSurface_162743((assetPath_33367[0].slice(0,-1)).concat(filename_181101), colonanonymous__181102);
}
function newSeq_187276(len_187280) {

var result_187282 = null;
result_187282 = new Array(len_187280); for (var i=0;i<len_187280;++i) {result_187282[i]=null;}return result_187282;
}
function new_184170() {

var result_184175 = null;
BeforeRet: do {
var r_184201 = null;
r_184201 = {m_type: NTI184048, mode: 0, weapon: 0, wasOnGround: false, wasOnWall: false, jump: false, jbuffer: 0, grace: 0, dir: 0, step: 0, ammo: 0, firing: false, score: 0, hp: 0, hitflash: 0, combo: 0, bulletTimer: 0, pos: {Field0: 0, Field1: 0}, vel: {Field0: 0.0, Field1: 0.0}, rem: {Field0: 0.0, Field1: 0.0}, hitbox: {Field0: 0, Field1: 0, Field2: 0, Field3: 0}, shouldKill: false, bounciness: 0.0, ethereal: false, riding: null};
result_184175 = r_184201;
break BeforeRet;
} while (false); 
return result_184175;
}
function newPlayer_184163(x_184165, y_184166) {

var result_184167 = null;
result_184167 = new_184170();
result_184167.pos.Field0 = x_184165;
result_184167.pos.Field1 = y_184166;
result_184167.hitbox.Field0 = 2;
result_184167.hitbox.Field2 = 4;
result_184167.hitbox.Field1 = 1;
result_184167.hitbox.Field3 = 7;
result_184167.hp = 4;
result_184167.hitflash = 0;
return result_184167;
}
function newMap_177460(w_177462, h_177463) {

currentTilemap_33353[0].w = (w_177462|0);
currentTilemap_33353[0].h = (h_177463|0);
currentTilemap_33353[0].data = nimCopy(null, newSeq_34219((w_177462 * h_177463)), NTI34224);
}
function mset_177440(tx_177442, ty_177443, t_177444) {

var Tmp1;
var Tmp2;
var Tmp3;
BeforeRet: do {
if ((tx_177442 < 0)) Tmp3 = true; else {Tmp3 = ((currentTilemap_33353[0].w - 1) < (tx_177442|0)); }if (Tmp3) Tmp2 = true; else {Tmp2 = (ty_177443 < 0); }if (Tmp2) Tmp1 = true; else {Tmp1 = ((currentTilemap_33353[0].h - 1) < (ty_177443|0)); }if (Tmp1) {
break BeforeRet;
}

currentTilemap_33353[0].data[(((ty_177443|0) * currentTilemap_33353[0].w) + (tx_177442|0))] = t_177444;
} while (false); 
}
function toPint_33305(x_33307) {

var result_33308 = 0;
BeforeRet: do {
result_33308 = x_33307;
break BeforeRet;
} while (false); 
return result_33308;
}
function random_169277(max_169279) {

var result_169280 = 0;
BeforeRet: do {
L1: do {
L2: while (true) {
if (!true) break L2;
var x_169282 = next_168841(state_168605[0]);
if ((x_169282 < ((4294967295 - (4294967295 % max_169279)) >>> 0))) {
result_169280 = ((x_169282 % max_169279)|0);
break BeforeRet;
}

}
} while(false);
} while (false); 
return result_169280;
}
function rnd_185630(x_185634) {

var result_185635 = 0;
BeforeRet: do {
if ((x_185634 == 0)) {
result_185635 = 0;
break BeforeRet;
}

result_185635 = random_169277(x_185634);
break BeforeRet;
} while (false); 
return result_185635;
}
function mget_177445(tx_177447, ty_177448) {

var Tmp1;
var Tmp2;
var Tmp3;
var result_179707 = 0;
BeforeRet: do {
if ((tx_177447 < 0)) Tmp3 = true; else {Tmp3 = ((currentTilemap_33353[0].w - 1) < (tx_177447|0)); }if (Tmp3) Tmp2 = true; else {Tmp2 = (ty_177448 < 0); }if (Tmp2) Tmp1 = true; else {Tmp1 = ((currentTilemap_33353[0].h - 1) < (ty_177448|0)); }if (Tmp1) {
result_179707 = 0;
break BeforeRet;
}

result_179707 = currentTilemap_33353[0].data[(((ty_177448|0) * currentTilemap_33353[0].w) + (tx_177447|0))];
break BeforeRet;
} while (false); 
return result_179707;
}
function new_184218() {

var result_184223 = null;
BeforeRet: do {
var r_184401 = null;
r_184401 = {m_type: NTI184073, hp: 0, hitflash: 0, pos: {Field0: 0, Field1: 0}, vel: {Field0: 0.0, Field1: 0.0}, rem: {Field0: 0.0, Field1: 0.0}, hitbox: {Field0: 0, Field1: 0, Field2: 0, Field3: 0}, shouldKill: false, bounciness: 0.0, ethereal: false, riding: null};
result_184223 = r_184401;
break BeforeRet;
} while (false); 
return result_184223;
}
function newCrate_184211(x_184213, y_184214) {

var result_184215 = null;
result_184215 = new_184218();
result_184215.pos.Field0 = x_184213;
result_184215.pos.Field1 = y_184214;
result_184215.hitbox.Field0 = 0;
result_184215.hitbox.Field2 = 8;
result_184215.hitbox.Field1 = 0;
result_184215.hitbox.Field3 = 8;
result_184215.hp = 4;
result_184215.hitflash = 0;
return result_184215;
}
function new_184419() {

var result_184424 = null;
BeforeRet: do {
var r_184601 = null;
r_184601 = {m_type: NTI184077, direction: 0, pos: {Field0: 0, Field1: 0}, vel: {Field0: 0.0, Field1: 0.0}, rem: {Field0: 0.0, Field1: 0.0}, hitbox: {Field0: 0, Field1: 0, Field2: 0, Field3: 0}, shouldKill: false, bounciness: 0.0, ethereal: false, riding: null};
result_184424 = r_184601;
break BeforeRet;
} while (false); 
return result_184424;
}
function newPlatform_184411(x_184413, y_184414, direction_184415) {

var result_184416 = null;
result_184416 = new_184419();
result_184416.pos.Field0 = x_184413;
result_184416.pos.Field1 = y_184414;
result_184416.hitbox.Field0 = 0;
result_184416.hitbox.Field2 = 8;
result_184416.hitbox.Field1 = 0;
result_184416.hitbox.Field3 = 8;
result_184416.direction = direction_184415;
result_184416.vel.Field0 = (direction_184415 * 1.0000000000000001e-001);
return result_184416;
}
function new_184619() {

var result_184624 = null;
BeforeRet: do {
var r_184801 = null;
r_184801 = {m_type: NTI184091, hp: 0, hitflash: 0, target: null, pos: {Field0: 0, Field1: 0}, vel: {Field0: 0.0, Field1: 0.0}, rem: {Field0: 0.0, Field1: 0.0}, hitbox: {Field0: 0, Field1: 0, Field2: 0, Field3: 0}, shouldKill: false, bounciness: 0.0, ethereal: false, riding: null};
result_184624 = r_184801;
break BeforeRet;
} while (false); 
return result_184624;
}
function newFloater_184612(x_184614, y_184615) {

var result_184616 = null;
result_184616 = new_184619();
result_184616.pos.Field0 = x_184614;
result_184616.pos.Field1 = y_184615;
result_184616.hitbox.Field0 = 1;
result_184616.hitbox.Field2 = 6;
result_184616.hitbox.Field1 = 1;
result_184616.hitbox.Field3 = 6;
result_184616.bounciness = 1.0000000000000000e+000;
result_184616.hp = 2;
result_184616.target = null;
return result_184616;
}
function gameInit_187261() {

var Tmp8;
var Tmp9;
var Tmp10;
var Tmp11;
var Tmp12;
var Tmp13;
loadPaletteCGA_177248();
loadSpriteSheet_181099(makeNimstrLit("platformer.png"));
objects_185415[0] = nimCopy(null, newSeq_187276(0), NTI187281);
player_184159[0] = newPlayer_184163(16, 8);
if (objects_185415[0] != null) { objects_185415[0].push(player_184159[0]); } else { objects_185415[0] = [player_184159[0]]; };
gameOver_184161[0] = false;
newMap_177460(16, 256);
L1: do {
var y_187321 = 0;
var i_187459 = 0;
L2: do {
L3: while (true) {
if (!(i_187459 < 256)) break L3;
y_187321 = i_187459;
L4: do {
var x_187331 = 0;
var i_187455 = 0;
L5: do {
L6: while (true) {
if (!(i_187455 < 16)) break L6;
x_187331 = i_187455;
L7: do {
if ((x_187331 <= 1)) Tmp8 = true; else {Tmp8 = (14 <= x_187331); }if (Tmp8) {
mset_177440(toPint_33305(x_187331), toPint_33305(y_187321), 255);
break L7;
}

if ((y_187321 == 3)) {
if ((x_187331 < 5)) Tmp9 = true; else {Tmp9 = (10 < x_187331); }if (Tmp9) {
mset_177440(toPint_33305(x_187331), toPint_33305(y_187321), (16 + rnd_185630(6)));
}

}

if ((16 < y_187321)) {
if ((x_187331 < 5)) Tmp11 = true; else {Tmp11 = (11 < x_187331); }if (Tmp11) {
Tmp10 = 4;
}
else {
Tmp10 = 16;
}

var chance_187339 = Tmp10;
if ((mget_177445(toPint_33305(x_187331), toPint_33305((y_187321 - 1))) == 5)) {
mset_177440(toPint_33305(x_187331), toPint_33305(y_187321), (16 + rnd_185630(6)));
}
else {
if ((rnd_185630(chance_187339) == 0)) {
if ((rnd_185630(20) == 0)) {
if (objects_185415[0] != null) { objects_185415[0].push(newCrate_184211((x_187331 * 8), (y_187321 * 8))); } else { objects_185415[0] = [newCrate_184211((x_187331 * 8), (y_187321 * 8))]; };
}
else {
if ((rnd_185630(20) == 0)) {
if ((rnd_185630(2) == 0)) {
Tmp12 = -1;
}
else {
Tmp12 = 1;
}

if (objects_185415[0] != null) { objects_185415[0].push(newPlatform_184411((x_187331 * 8), (y_187321 * 8), Tmp12)); } else { objects_185415[0] = [newPlatform_184411((x_187331 * 8), (y_187321 * 8), Tmp12)]; };
}
else {
if (((rnd_185630(20) == 0) && (mget_177445(toPint_33305(x_187331), toPint_33305((y_187321 - 1))) == 0))) {
mset_177440(toPint_33305(x_187331), toPint_33305(y_187321), 5);
}
else {
if ((mget_177445(toPint_33305(x_187331), toPint_33305((y_187321 - 1))) == 0)) {
mset_177440(toPint_33305(x_187331), toPint_33305(y_187321), (16 + rnd_185630(6)));
}
else {
mset_177440(toPint_33305(x_187331), toPint_33305(y_187321), (22 + rnd_185630(6)));
}
}}}
}
else {
if (!(32 < y_187321)) Tmp13 = false; else {Tmp13 = (rnd_185630(64) == 0); }if (Tmp13) {
if (objects_185415[0] != null) { objects_185415[0].push(newFloater_184612((x_187331 * 8), (y_187321 * 8))); } else { objects_185415[0] = [newFloater_184612((x_187331 * 8), (y_187321 * 8))]; };
}

}
}
}

} while(false);
i_187455 += 1;
}
} while(false);
} while(false);
i_187459 += 1;
}
} while(false);
} while(false);
}
function axisp_26026(self_26028, axis_26029, value_26030) {

var Tmp1;
var Tmp2;
var Tmp3;
var result_26031 = false;
BeforeRet: do {
if ((value_26030 == -1.0000000000000000e+000)) {
if (!(self_26028.axes[axis_26029].Field0 < -(self_26028.deadzone))) Tmp1 = false; else {Tmp1 = !((self_26028.axes[axis_26029].Field1 < -(self_26028.deadzone))); }result_26031 = Tmp1;
break BeforeRet;
}

if ((value_26030 == 1.0000000000000000e+000)) {
if (!(self_26028.deadzone < self_26028.axes[axis_26029].Field0)) Tmp2 = false; else {Tmp2 = !((self_26028.deadzone < self_26028.axes[axis_26029].Field1)); }result_26031 = Tmp2;
break BeforeRet;
}

if ((value_26030 == 0.0)) {
if (!(Math.abs(self_26028.axes[axis_26029].Field0) < self_26028.deadzone)) Tmp3 = false; else {Tmp3 = !((Math.abs(self_26028.axes[axis_26029].Field1) < self_26028.deadzone)); }result_26031 = Tmp3;
break BeforeRet;
}

} while (false); 
return result_26031;
}
function btnp_26070(self_26072, button_26073) {

var Tmp1;
var Tmp2;
var Tmp3;
var Tmp4;
var result_26074 = false;
BeforeRet: do {
if ((button_26073 == 2)) {
if ((self_26072.buttons[button_26073] == 2)) Tmp1 = true; else {Tmp1 = axisp_26026(self_26072, 0, -1.0000000000000000e+000); }result_26074 = Tmp1;
break BeforeRet;
}
else {
if ((button_26073 == 3)) {
if ((self_26072.buttons[button_26073] == 2)) Tmp2 = true; else {Tmp2 = axisp_26026(self_26072, 0, 1.0000000000000000e+000); }result_26074 = Tmp2;
break BeforeRet;
}
else {
if ((button_26073 == 0)) {
if ((self_26072.buttons[button_26073] == 2)) Tmp3 = true; else {Tmp3 = axisp_26026(self_26072, 1, -1.0000000000000000e+000); }result_26074 = Tmp3;
break BeforeRet;
}
else {
if ((button_26073 == 1)) {
if ((self_26072.buttons[button_26073] == 2)) Tmp4 = true; else {Tmp4 = axisp_26026(self_26072, 1, 1.0000000000000000e+000); }result_26074 = Tmp4;
break BeforeRet;
}
}}}
result_26074 = (self_26072.buttons[button_26073] == 2);
break BeforeRet;
} while (false); 
return result_26074;
}
function btnp_177280(b_177282) {

var result_177767 = false;
BeforeRet: do {
L1: do {
var c_177776 = null;
var i_177780 = 0;
var L_177782 = (controllers_33347[0] != null ? controllers_33347[0].length : 0);
L2: do {
L3: while (true) {
if (!(i_177780 < L_177782)) break L3;
c_177776 = controllers_33347[0][i_177780];
if (btnp_26070(c_177776, b_177282)) {
result_177767 = true;
break BeforeRet;
}

i_177780 += 1;
}
} while(false);
} while(false);
result_177767 = false;
break BeforeRet;
} while (false); 
return result_177767;
}
function pluseq__185776(x_185781, x_185781_Idx, y_185783) {

x_185781[x_185781_Idx] = (x_185781[x_185781_Idx] + y_185783);
}
function flr_177464(x_177466) {

var result_178572 = 0.0;
BeforeRet: do {
result_178572 = Math.floor(x_177466);
break BeforeRet;
} while (false); 
return result_178572;
}
function minuseq__186332(x_186337, x_186337_Idx, y_186339) {

x_186337[x_186337_Idx] = (x_186337[x_186337_Idx] - y_186339);
}
function sgn_185985(x_185989) {

var result_185990 = 0;
BeforeRet: do {
if ((x_185989 < 0)) {
result_185990 = -1;
break BeforeRet;
}
else {
if ((0 < x_185989)) {
result_185990 = 1;
break BeforeRet;
}
else {
result_185990 = 0;
break BeforeRet;
}
}
} while (false); 
return result_185990;
}
function overlaps_185430(a_185432, b_185433, ox_185434, oy_185435) {

var Tmp1;
var Tmp2;
var Tmp3;
var result_185436 = false;
BeforeRet: do {
var ax0_185437 = ((a_185432.pos.Field0 + a_185432.hitbox.Field0) + ox_185434);
var ax1_185438 = ((((a_185432.pos.Field0 + a_185432.hitbox.Field0) + ox_185434) + a_185432.hitbox.Field2) - 1);
var ay0_185439 = ((a_185432.pos.Field1 + a_185432.hitbox.Field1) + oy_185435);
var ay1_185440 = ((((a_185432.pos.Field1 + a_185432.hitbox.Field1) + oy_185435) + a_185432.hitbox.Field3) - 1);
var bx0_185441 = (b_185433.pos.Field0 + b_185433.hitbox.Field0);
var bx1_185442 = (((b_185433.pos.Field0 + b_185433.hitbox.Field0) + b_185433.hitbox.Field2) - 1);
var by0_185443 = (b_185433.pos.Field1 + b_185433.hitbox.Field1);
var by1_185444 = (((b_185433.pos.Field1 + b_185433.hitbox.Field1) + b_185433.hitbox.Field3) - 1);
if ((bx1_185442 < ax0_185437)) Tmp3 = true; else {Tmp3 = (by1_185444 < ay0_185439); }if (Tmp3) Tmp2 = true; else {Tmp2 = (ax1_185438 < bx0_185441); }if (Tmp2) Tmp1 = true; else {Tmp1 = (ay1_185440 < by0_185443); }result_185436 = !(Tmp1);
break BeforeRet;
} while (false); 
return result_185436;
}
function check_186016(self_186020, x_186024, y_186026) {

var Tmp4;
var result_186027 = false;
BeforeRet: do {
L1: do {
var o_186202 = null;
var i_186216 = 0;
var L_186218 = (objects_185415[0] != null ? objects_185415[0].length : 0);
L2: do {
L3: while (true) {
if (!(i_186216 < L_186218)) break L3;
o_186202 = objects_185415[0][i_186216];
if (!!((o_186202 == self_186020))) Tmp4 = false; else {Tmp4 = isObj(o_186202.m_type, NTI184071); }if (Tmp4) {
if (overlaps_185430(self_186020, o_186202, x_186024, y_186026)) {
result_186027 = true;
break BeforeRet;
}

}

i_186216 += 1;
}
} while(false);
} while(false);
result_186027 = false;
break BeforeRet;
} while (false); 
return result_186027;
}
function moveX_185979(self_185981, amount_185982, start_185983) {

var Tmp4;
var step_185991 = sgn_185985((amount_185982|0));
L1: do {
var i_186013 = 0;
var colontmp__186258 = 0;
colontmp__186258 = Math.abs((amount_185982|0));
var i_186261 = (start_185983|0);
L2: do {
L3: while (true) {
if (!(i_186261 < colontmp__186258)) break L3;
i_186013 = i_186261;
if (self_185981.ethereal) Tmp4 = true; else {Tmp4 = (!(isSolid_185581(self_185981, step_185991, 0)) && !(check_186016(self_185981, step_185991, 0))); }if (Tmp4) {
self_185981.pos.Field0 += step_185991;
L5: do {
var obj_186236 = null;
var i_186254 = 0;
var L_186256 = (objects_185415[0] != null ? objects_185415[0].length : 0);
L6: do {
L7: while (true) {
if (!(i_186254 < L_186256)) break L7;
obj_186236 = objects_185415[0][i_186254];
if ((obj_186236.riding == self_185981)) {
moveX_185979(obj_186236, step_185991, 0.0);
}

i_186254 += 1;
}
} while(false);
} while(false);
}
else {
self_185981.vel.Field0 = (-(self_185981.vel.Field0) * self_185981.bounciness);
self_185981.rem.Field0 = 0.0;
break L1;
}

i_186261 += 1;
}
} while(false);
} while(false);
}
function moveY_186263(self_186265, amount_186266) {

var Tmp4;
var step_186273 = sgn_185985((amount_186266|0));
L1: do {
var i_186283 = 0;
var colontmp__186310 = 0;
colontmp__186310 = Math.abs((amount_186266|0));
var i_186313 = 0;
L2: do {
L3: while (true) {
if (!(i_186313 < colontmp__186310)) break L3;
i_186283 = i_186313;
if (self_186265.ethereal) Tmp4 = true; else {Tmp4 = (!(isSolid_185581(self_186265, 0, step_186273)) && !(check_186016(self_186265, 0, step_186273))); }if (Tmp4) {
self_186265.pos.Field1 += step_186273;
}
else {
self_186265.vel.Field1 = (-(self_186265.vel.Field1) * self_186265.bounciness);
self_186265.rem.Field1 = 0.0;
break L1;
}

i_186313 += 1;
}
} while(false);
} while(false);
}
function move_186315(self_186317, ox_186318, oy_186319) {

pluseq__185776(self_186317.rem, "Field0", ox_186318);
var amount_186330 = flr_177464((self_186317.rem.Field0 + 5.0000000000000000e-001));
minuseq__186332(self_186317.rem, "Field0", amount_186330);
moveX_185979(self_186317, amount_186330, 0.0);
pluseq__185776(self_186317.rem, "Field1", oy_186319);
amount_186330 = flr_177464((self_186317.rem.Field1 + 5.0000000000000000e-001));
minuseq__186332(self_186317.rem, "Field1", amount_186330);
moveY_186263(self_186317, amount_186330);
}
function overlaps_185417(a_185419, b_185420) {

var Tmp1;
var Tmp2;
var Tmp3;
var result_185421 = false;
BeforeRet: do {
var ax0_185422 = (a_185419.pos.Field0 + a_185419.hitbox.Field0);
var ax1_185423 = (((a_185419.pos.Field0 + a_185419.hitbox.Field0) + a_185419.hitbox.Field2) - 1);
var ay0_185424 = (a_185419.pos.Field1 + a_185419.hitbox.Field1);
var ay1_185425 = (((a_185419.pos.Field1 + a_185419.hitbox.Field1) + a_185419.hitbox.Field3) - 1);
var bx0_185426 = (b_185420.pos.Field0 + b_185420.hitbox.Field0);
var bx1_185427 = (((b_185420.pos.Field0 + b_185420.hitbox.Field0) + b_185420.hitbox.Field2) - 1);
var by0_185428 = (b_185420.pos.Field1 + b_185420.hitbox.Field1);
var by1_185429 = (((b_185420.pos.Field1 + b_185420.hitbox.Field1) + b_185420.hitbox.Field3) - 1);
if ((bx1_185427 < ax0_185422)) Tmp3 = true; else {Tmp3 = (by1_185429 < ay0_185424); }if (Tmp3) Tmp2 = true; else {Tmp2 = (ax1_185423 < bx0_185426); }if (Tmp2) Tmp1 = true; else {Tmp1 = (ay1_185425 < by0_185428); }result_185421 = !(Tmp1);
break BeforeRet;
} while (false); 
return result_185421;
}
function keepIf_187648(seq1_187654, seq1_187654_Idx, pred_187659) {

var pos_187660 = 0;
L1: do {
var i_187684 = 0;
var colontmp__187705 = 0;
colontmp__187705 = (seq1_187654[seq1_187654_Idx] != null ? seq1_187654[seq1_187654_Idx].length : 0) - 1;
var res_187708 = 0;
L2: do {
L3: while (true) {
if (!(res_187708 <= colontmp__187705)) break L3;
i_187684 = res_187708;
if (pred_187659(seq1_187654[seq1_187654_Idx][i_187684])) {
if (!((pos_187660 == i_187684))) {
seq1_187654[seq1_187654_Idx][pos_187660] = seq1_187654[seq1_187654_Idx][i_187684];
}

pos_187660 += 1;
}

res_187708 += 1;
}
} while(false);
} while(false);
seq1_187654[seq1_187654_Idx].length = pos_187660;
}
function lerp_187714(a_187718, b_187720, t_187722) {

var result_187723 = 0.0;
BeforeRet: do {
result_187723 = (a_187718 + ((b_187720 - a_187718) * t_187722));
break BeforeRet;
} while (false); 
return result_187723;
}
function gameUpdate_187461(dt_187463) {

function colonanonymous__187640(a_187642) {

var result_187643 = false;
result_187643 = (a_187642.shouldKill == false);
return result_187643;
}
frame_184001[0] += 1;
if (btnp_177280(7)) {
gameInit_187261();
}

if (btnp_177280(6)) {
player_184159[0].weapon = 1;
}

if (!(gameOver_184161[0])) {
L1: do {
var obj_187603 = [null, 0];
var obj_187603_Idx = 0;
var i_187727 = 0;
var L_187729 = (objects_185415[0] != null ? objects_185415[0].length : 0);
L2: do {
L3: while (true) {
if (!(i_187727 < L_187729)) break L3;
obj_187603 = objects_185415[0]; obj_187603_Idx = i_187727;
move_186315(obj_187603[obj_187603_Idx], obj_187603[obj_187603_Idx].vel.Field0, obj_187603[obj_187603_Idx].vel.Field1);
update_186366(obj_187603[obj_187603_Idx]);
i_187727 += 1;
}
} while(false);
} while(false);
L4: do {
var i_187620 = 0;
var colontmp__187738 = 0;
colontmp__187738 = (objects_185415[0] != null ? objects_185415[0].length : 0);
var i_187741 = 0;
L5: do {
L6: while (true) {
if (!(i_187741 < colontmp__187738)) break L6;
i_187620 = i_187741;
L7: do {
var j_187637 = 0;
var colontmp__187732 = 0;
var colontmp__187733 = 0;
colontmp__187732 = (i_187620 + 1);
colontmp__187733 = (objects_185415[0] != null ? objects_185415[0].length : 0);
var i_187736 = colontmp__187732;
L8: do {
L9: while (true) {
if (!(i_187736 < colontmp__187733)) break L9;
j_187637 = i_187736;
var a_187638 = objects_185415[0][i_187620];
var b_187639 = objects_185415[0][j_187637];
if (overlaps_185417(a_187638, b_187639)) {
collide_185601(a_187638, b_187639);
}

i_187736 += 1;
}
} while(false);
} while(false);
i_187741 += 1;
}
} while(false);
} while(false);
keepIf_187648(objects_185415, 0, colonanonymous__187640);
}

cy_185413[0] = lerp_187714(cy_185413[0], (player_184159[0].pos.Field1 - 6.4000000000000000e+001), 1.0000000000000001e-001);
}
function setCamera_177270(x_177272, y_177273) {

cameraX_33420[0] = x_177272;
cameraY_33422[0] = y_177273;
}
function getSprRect_181105(spr_181109, w_181110, h_181111) {

var result_181112 = {Field0: 0, Field1: 0, Field2: 0, Field3: 0};
result_181112.Field0 = ((spr_181109 % 16) * 8);
result_181112.Field1 = (Math.floor(spr_181109 / 16) * 8);
result_181112.Field2 = ((w_181110 * 8)|0);
result_181112.Field3 = ((h_181111 * 8)|0);
return result_181112;
}
function overlap_179116(a_179118, b_179119) {

var Tmp1;
var Tmp2;
var Tmp3;
var result_179120 = false;
BeforeRet: do {
if (((b_179119.Field0 + b_179119.Field2) < a_179118.Field0)) Tmp3 = true; else {Tmp3 = ((b_179119.Field1 + b_179119.Field3) < a_179118.Field1); }if (Tmp3) Tmp2 = true; else {Tmp2 = ((a_179118.Field0 + a_179118.Field2) < b_179119.Field0); }if (Tmp2) Tmp1 = true; else {Tmp1 = ((a_179118.Field1 + a_179118.Field3) < b_179119.Field1); }result_179120 = !(Tmp1);
break BeforeRet;
} while (false); 
return result_179120;
}
function blitFast_179211(src_179213, sx_179214, sy_179215, dx_179216, dy_179217, w_179218, h_179219) {

var Tmp4;
var Tmp5;
var Tmp6;
var Tmp10;
var Tmp11;
var Tmp12;
var sxi_179220 = sx_179214;
var syi_179221 = sy_179215;
var dxi_179222 = dx_179216;
var dyi_179223 = dy_179217;
L1: do {
L2: while (true) {
if (!(dyi_179223 < (dy_179217 + h_179219))) break L2;
L3: do {
if ((syi_179221 < 0)) Tmp6 = true; else {Tmp6 = ((src_179213.h - 1) < (syi_179221|0)); }if (Tmp6) Tmp5 = true; else {Tmp5 = ((dyi_179223|0) < clipMinY_33467[0]); }if (Tmp5) Tmp4 = true; else {Tmp4 = (clipMaxY_33468[0] < (dyi_179223|0)); }if (Tmp4) {
syi_179221 += 1;
dyi_179223 += 1;
sxi_179220 = sx_179214;
dxi_179222 = dx_179216;
break L3;
}

L7: do {
L8: while (true) {
if (!(dxi_179222 < (dx_179216 + w_179218))) break L8;
L9: do {
if ((sxi_179220 < 0)) Tmp12 = true; else {Tmp12 = ((src_179213.w - 1) < (sxi_179220|0)); }if (Tmp12) Tmp11 = true; else {Tmp11 = ((dxi_179222|0) < clipMinX_33465[0]); }if (Tmp11) Tmp10 = true; else {Tmp10 = (clipMaxX_33466[0] < (dxi_179222|0)); }if (Tmp10) {
dxi_179222 += 1;
sxi_179220 += 1;
break L9;
}

var srcCol_179260 = src_179213.data[(((syi_179221|0) * src_179213.w) + (sxi_179220|0))];
if (!(paletteTransparent_33440[0][srcCol_179260])) {
swCanvas_33316[0].data[(((dyi_179223|0) * swCanvas_33316[0].w) + (dxi_179222|0))] = paletteMapDraw_33430[0][srcCol_179260];
}

sxi_179220 += 1;
dxi_179222 += 1;
} while(false);
}
} while(false);
syi_179221 += 1;
dyi_179223 += 1;
sxi_179220 = sx_179214;
dxi_179222 = dx_179216;
} while(false);
}
} while(false);
}
function drawTile_181234(spr_181238, x_181239, y_181240, tileSize_181241) {

var src_181242 = getSprRect_181105(spr_181238, 1, 1);
var x_181243 = (x_181239 - cameraX_33420[0]);
var y_181244 = (y_181240 - cameraY_33422[0]);
if (overlap_179116(clippingRect_33473[0], {Field0: (x_181243|0), Field1: (y_181244|0), Field2: tileSize_181241, Field3: tileSize_181241})) {
blitFast_179211(spriteSheet_33378[0], toPint_33305(src_181242.Field0), toPint_33305(src_181242.Field1), x_181243, y_181244, toPint_33305(tileSize_181241), toPint_33305(tileSize_181241));
}

}
function mapDraw_177449(tx_177451, ty_177452, tw_177453, th_177454, dx_177455, dy_177456) {

var Tmp4;
var Tmp8;
BeforeRet: do {
if (eqeq__180526(currentTilemap_33353[0].data, null)) {
break BeforeRet;
}

var xi_181295 = dx_177455;
var yi_181296 = dy_177456;
var increment_181297 = 8;
L1: do {
var y_181307 = 0;
var colontmp__181354 = 0;
colontmp__181354 = ((ty_177452 + th_177454) - 1);
var res_181357 = (ty_177452|0);
L2: do {
L3: while (true) {
if (!(res_181357 <= (colontmp__181354|0))) break L3;
y_181307 = res_181357;
if (!(0 <= y_181307)) Tmp4 = false; else {Tmp4 = ((y_181307|0) < currentTilemap_33353[0].h); }if (Tmp4) {
L5: do {
var x_181317 = 0;
var colontmp__181347 = 0;
colontmp__181347 = ((tx_177451 + tw_177453) - 1);
var res_181350 = (tx_177451|0);
L6: do {
L7: while (true) {
if (!(res_181350 <= (colontmp__181347|0))) break L7;
x_181317 = res_181350;
if (!(0 <= x_181317)) Tmp8 = false; else {Tmp8 = ((x_181317|0) < currentTilemap_33353[0].w); }if (Tmp8) {
var t_181318 = currentTilemap_33353[0].data[(((y_181307|0) * currentTilemap_33353[0].w) + (x_181317|0))];
if (!((t_181318 == 0))) {
drawTile_181234((t_181318|0), xi_181295, yi_181296, increment_181297);
}

}

xi_181295 += toPint_33305(increment_181297);
res_181350 += 1;
}
} while(false);
} while(false);
}

yi_181296 += toPint_33305(increment_181297);
xi_181295 = dx_177455;
res_181357 += 1;
}
} while(false);
} while(false);
} while (false); 
}
function setColor_177238(colId_177240) {

currentColor_33459[0] = colId_177240;
}
function pset_177327(x_177329, y_177330) {

var Tmp1;
var Tmp2;
var Tmp3;
BeforeRet: do {
var x_177943 = (x_177329 - cameraX_33420[0]);
var y_177944 = (y_177330 - cameraY_33422[0]);
if (((x_177943|0) < clipMinX_33465[0])) Tmp3 = true; else {Tmp3 = ((y_177944|0) < clipMinY_33467[0]); }if (Tmp3) Tmp2 = true; else {Tmp2 = (clipMaxX_33466[0] < (x_177943|0)); }if (Tmp2) Tmp1 = true; else {Tmp1 = (clipMaxY_33468[0] < (y_177944|0)); }if (Tmp1) {
break BeforeRet;
}

swCanvas_33316[0].data[(((y_177944|0) * swCanvas_33316[0].w) + (x_177943|0))] = paletteMapDraw_33430[0][currentColor_33459[0]];
} while (false); 
}
function toPint_33295(x_33297) {

var result_33298 = 0;
BeforeRet: do {
result_33298 = x_33297;
break BeforeRet;
} while (false); 
return result_33298;
}
function minuseq__171181(x_171186, x_171186_Idx, y_171188) {

x_171186[x_171186_Idx] = (x_171186[x_171186_Idx] - y_171188);
}
function pluseq__54511(x_54516, x_54516_Idx, y_54518) {

x_54516[x_54516_Idx] = (x_54516[x_54516_Idx] + y_54518);
}
function innerLine_178240(x0_178242, y0_178243, x1_178244, y1_178245) {

var Tmp1;
var Tmp2;
var Tmp3;
var x_178246 = x0_178242;
var y_178247 = y0_178243;
var dx_178248 = (Math.abs((x1_178244 - x0_178242))|0);
if ((x0_178242 < x1_178244)) {
Tmp1 = 1;
}
else {
Tmp1 = -1;
}

var sx_178249 = Tmp1;
var dy_178250 = (Math.abs((y1_178245 - y0_178243))|0);
if ((y0_178243 < y1_178245)) {
Tmp2 = 1;
}
else {
Tmp2 = -1;
}

var sy_178251 = Tmp2;
if ((dy_178250 < dx_178248)) {
Tmp3 = dx_178248;
}
else {
Tmp3 = -(dy_178250);
}

var err_178252 = /**/[(Tmp3 / 2.0000000000000000e+000)];
var e2_178253 = 0.0;
L4: do {
L5: while (true) {
if (!true) break L5;
pset_177327(x_178246, y_178247);
if (((x_178246 == x1_178244) && (y_178247 == y1_178245))) {
break L4;
}

e2_178253 = err_178252[0];
if ((toPint_33305(-(dx_178248)) < toPint_33295(e2_178253))) {
minuseq__171181(err_178252, 0, dy_178250);
x_178246 += toPint_33305(sx_178249);
}

if ((toPint_33295(e2_178253) < toPint_33305(dy_178250))) {
pluseq__54511(err_178252, 0, dx_178248);
y_178247 += toPint_33305(sy_178251);
}

}
} while(false);
}
function line_177356(x0_177358, y0_177359, x1_177360, y1_177361) {

if (((x0_177358 == x1_177360) && (y0_177359 == y1_177361))) {
pset_177327(x0_177358, y0_177359);
}
else {
innerLine_178240(x0_177358, y0_177359, x1_177360, y1_177361);
}

}
function fontBlit_179003(font_179005, srcRect_179006, dstRect_179007, color_179008) {

var Tmp8;
var Tmp9;
var Tmp10;
var Tmp11;
var dx_179009 = /**/[dstRect_179007.Field0];
var dy_179010 = /**/[dstRect_179007.Field1];
var sx_179011 = /**/[srcRect_179006.Field0];
var sy_179012 = /**/[srcRect_179006.Field1];
var dw_179013 = dstRect_179007.Field2;
var dh_179014 = dstRect_179007.Field3;
var sw_179015 = srcRect_179006.Field2;
var sh_179016 = srcRect_179006.Field3;
L1: do {
var y_179026 = 0;
var colontmp__179109 = 0;
colontmp__179109 = (dstRect_179007.Field3 - 1);
var res_179112 = 0;
L2: do {
L3: while (true) {
if (!(res_179112 <= colontmp__179109)) break L3;
y_179026 = res_179112;
dx_179009[0] = dstRect_179007.Field0;
sx_179011[0] = srcRect_179006.Field0;
L4: do {
var x_179036 = 0;
var colontmp__179102 = 0;
colontmp__179102 = (dstRect_179007.Field2 - 1);
var res_179105 = 0;
L5: do {
L6: while (true) {
if (!(res_179105 <= colontmp__179102)) break L6;
x_179036 = res_179105;
L7: do {
if (((sx_179011[0] < 0.0) || (sy_179012[0] < 0.0))) Tmp9 = true; else {Tmp9 = (toPint_33305((font_179005.w - 1)) < toPint_33295(sx_179011[0])); }if (Tmp9) Tmp8 = true; else {Tmp8 = (toPint_33305((font_179005.h - 1)) < toPint_33295(sy_179012[0])); }if (Tmp8) {
break L7;
}

if (((toPint_33295(dx_179009[0]) < toPint_33305(clipMinX_33465[0])) || (toPint_33295(dy_179010[0]) < toPint_33305(clipMinY_33467[0])))) Tmp11 = true; else {Tmp11 = (toPint_33305(clipMaxX_33466[0]) < toPint_33295(dx_179009[0])); }if (Tmp11) Tmp10 = true; else {Tmp10 = (toPint_33305(clipMaxY_33468[0]) < toPint_33295(dy_179010[0])); }if (Tmp10) {
break L7;
}

if ((font_179005.data[((toPint_33295(sy_179012[0]) * toPint_33305(font_179005.w)) + toPint_33295(sx_179011[0]))] == 1)) {
swCanvas_33316[0].data[((toPint_33295(dy_179010[0]) * toPint_33305(swCanvas_33316[0].w)) + toPint_33295(dx_179009[0]))] = currentColor_33459[0];
}

pluseq__54511(sx_179011, 0, (1.0000000000000000e+000 * (sw_179015 / dw_179013)));
pluseq__54511(dx_179009, 0, 1.0000000000000000e+000);
} while(false);
res_179105 += 1;
}
} while(false);
} while(false);
pluseq__54511(sy_179012, 0, (1.0000000000000000e+000 * (sh_179016 / dh_179014)));
pluseq__54511(dy_179010, 0, 1.0000000000000000e+000);
res_179112 += 1;
}
} while(false);
} while(false);
}
function glyph_177206(c_177208, x_177209, y_177210, scale_177211) {

var Tmp2;
var result_180206 = 0;
BeforeRet: do {
var font_180207 = fonts_33402[0][currentFontId_33404[0]];
if ((font_180207 == null)) {
result_180206 = 0;
break BeforeRet;
}

if (((font_180207.rects != null ? (font_180207.rects.length-1) : -1) < (c_177208|0))) {
break BeforeRet;
}

var src_180219 = nimCopy(null, font_180207.rects[c_177208], NTI33206);
var dst_180221 = nimCopy(null, {Field0: (x_177209|0), Field1: (y_177210|0), Field2: (src_180219.Field2 * (scale_177211|0)), Field3: (src_180219.Field3 * (scale_177211|0))}, NTI33206);
++excHandler;
Tmp2 = framePtr;
try {
fontBlit_179003(font_180207, src_180219, dst_180221, currentColor_33459[0]);
--excHandler;
} catch (EXC) {
 var prevJSError = lastJSError;
 lastJSError = EXC;
 --excHandler;
framePtr = Tmp2;
if (lastJSError && (isObj(lastJSError.m_type, NTI3454))) {
rawEcho(makeNimstrLit("index error glyph: "), nimCharToStr(c_177208), makeNimstrLit(" @ "), cstrToNimstr(((x_177209|0))+""), makeNimstrLit(","), cstrToNimstr(((y_177210|0))+""));
reraiseException();
}
else {
reraiseException();
}
lastJSError = prevJSError;
} finally {
framePtr = Tmp2;
}
result_180206 = toPint_33305(((src_180219.Field2 * (scale_177211|0)) + (scale_177211|0)));
break BeforeRet;
} while (false); 
return result_180206;
}
function print_177212(text_177214, x_177215, y_177216, scale_177217) {

var x_180235 = (x_177215 - cameraX_33420[0]);
var y_180236 = (y_177216 - cameraY_33422[0]);
L1: do {
var c_180238 = 0;
var i_180251 = 0;
var L_180253 = (text_177214 != null ? text_177214.length-1 : 0);
L2: do {
L3: while (true) {
if (!(i_180251 < L_180253)) break L3;
c_180238 = text_177214[i_180251];
x_180235 += glyph_177206(c_180238, x_180235, y_180236, scale_177217);
i_180251 += 1;
}
} while(false);
} while(false);
}
function rectfill_177344(x1_177346, y1_177347, x2_177348, y2_177349) {

var minx_177998 = nimMin(x1_177346, x2_177348);
var maxx_177999 = nimMax(x1_177346, x2_177348);
var miny_178000 = nimMin(y1_177347, y2_177349);
var maxy_178001 = nimMax(y1_177347, y2_177349);
L1: do {
var y_178215 = 0;
var res_178236 = (miny_178000|0);
L2: do {
L3: while (true) {
if (!(res_178236 <= (maxy_178001|0))) break L3;
y_178215 = res_178236;
L4: do {
var x_178225 = 0;
var res_178230 = (minx_177998|0);
L5: do {
L6: while (true) {
if (!(res_178230 <= (maxx_177999|0))) break L6;
x_178225 = res_178230;
pset_177327(x_178225, y_178215);
res_178230 += 1;
}
} while(false);
} while(false);
res_178236 += 1;
}
} while(false);
} while(false);
}
function gameDraw_187744() {

var Tmp4;
var Tmp5;
cls_177888();
setCamera_177270(toPint_33305((cx_185412[0]|0)), toPint_33305((cy_185413[0]|0)));
mapDraw_177449(0, 0, 16, 256, 0, 0);
setColor_177238(1);
line_177356(15, toPint_33295(cy_185413[0]), 15, toPint_33295((cy_185413[0] + 1.2700000000000000e+002)));
line_177356(112, toPint_33295(cy_185413[0]), 112, toPint_33295((cy_185413[0] + 1.2700000000000000e+002)));
L1: do {
var obj_187763 = null;
var i_187813 = 0;
var L_187815 = (objects_185415[0] != null ? objects_185415[0].length : 0);
L2: do {
L3: while (true) {
if (!(i_187813 < L_187815)) break L3;
obj_187763 = objects_185415[0][i_187813];
draw_187222(obj_187763);
i_187813 += 1;
}
} while(false);
} while(false);
setCamera_177270(0, 0);
setColor_177238(3);
print_177212(cstrToNimstr((player_184159[0].score)+""), 1, 1, 1);
if (!(0 < player_184159[0].hitflash)) Tmp5 = false; else {Tmp5 = (Math.floor(frame_184001[0] % 10) < 5); }if (Tmp5) {
Tmp4 = 3;
}
else {
Tmp4 = 1;
}

setColor_177238(Tmp4);
rectfill_177344(toPint_33305((126 - (player_184159[0].hp * 8))), 1, 126, 4);
setColor_177238(2);
rectfill_177344(124, 10, 126, toPint_33305((10 + (4 * player_184159[0].ammo))));
if (gameOver_184161[0]) {
setColor_177238(2);
print_177212(makeNimstrLit("GAME OVER"), 48, 60, 1);
}

}
run_181760(gameInit_187261, gameUpdate_187461, gameDraw_187744);
function isTouchingType_185497(x_185499, y_185500, w_185501, h_185502, check_185506) {

var Tmp1;
var Tmp2;
var result_185507 = false;
BeforeRet: do {
if ((x_185499 < 0)) Tmp2 = true; else {Tmp2 = (127 < (x_185499 + w_185501)); }if (Tmp2) Tmp1 = true; else {Tmp1 = (y_185500 < 0); }if (Tmp1) {
result_185507 = check_185506(255);
break BeforeRet;
}

L3: do {
var i_185519 = 0;
var colontmp__185542 = 0;
var colontmp__185543 = 0;
colontmp__185542 = nimMax(0, Math.floor(x_185499 / 8));
colontmp__185543 = nimMin(15, Math.floor(((x_185499 + w_185501) - 1) / 8));
var res_185546 = colontmp__185542;
L4: do {
L5: while (true) {
if (!(res_185546 <= colontmp__185543)) break L5;
i_185519 = res_185546;
L6: do {
var j_185530 = 0;
var colontmp__185534 = 0;
var colontmp__185535 = 0;
colontmp__185534 = nimMax(0, Math.floor(y_185500 / 8));
colontmp__185535 = nimMin(254, Math.floor(((y_185500 + h_185502) - 1) / 8));
var res_185538 = colontmp__185534;
L7: do {
L8: while (true) {
if (!(res_185538 <= colontmp__185535)) break L8;
j_185530 = res_185538;
var t_185531 = mget_177445(toPint_33305(i_185519), toPint_33305(j_185530));
if (check_185506(t_185531)) {
result_185507 = true;
break BeforeRet;
}

res_185538 += 1;
}
} while(false);
} while(false);
res_185546 += 1;
}
} while(false);
} while(false);
result_185507 = false;
break BeforeRet;
} while (false); 
return result_185507;
}
function isSolid_185456(t_185458) {

var Tmp1;
var Tmp2;
var result_185459 = false;
BeforeRet: do {
if (!!((t_185458 == 0))) Tmp2 = false; else {Tmp2 = !((t_185458 == 33)); }if (!Tmp2) Tmp1 = false; else {Tmp1 = !((t_185458 == 5)); }result_185459 = Tmp1;
break BeforeRet;
} while (false); 
return result_185459;
}
function isSolid_185574(self_185576, ox_185577, oy_185578) {

var result_185579 = false;
BeforeRet: do {
result_185579 = isTouchingType_185497(((self_185576.pos.Field0 + self_185576.hitbox.Field0) + ox_185577), ((self_185576.pos.Field1 + self_185576.hitbox.Field1) + oy_185578), self_185576.hitbox.Field2, self_185576.hitbox.Field3, isSolid_185456);
break BeforeRet;
} while (false); 
return result_185579;
}
function isSolid_185581(self_185576, ox_185577, oy_185578) {

var result_185584 = false;
BeforeRet: do {
result_185584 = isSolid_185574(self_185576, ox_185577, oy_185578);
break BeforeRet;
} while (false); 
return result_185584;
}
function sysFatal_18852(message_18858) {

var e_18860 = null;
e_18860 = {m_type: NTI3482, parent: null, name: null, message: null, trace: null};
e_18860.message = nimCopy(null, message_18858, NTI138);
raiseException(e_18860, "NilAccessError");
}
function chckNilDisp(p_18849, p_18849_Idx) {

if ((p_18849_Idx == 0)) {
sysFatal_18852(makeNimstrLit("cannot dispatch; dispatcher is nil"));
}

}
function collide_185603(a_185605, b_185606) {

}
function collide_185611(a_185613, b_185614) {

b_185614.shouldKill = true;
a_185613.score += 10;
}
function collide_185607(a_185609, b_185610) {

}
function pluseq__185765(a_185771, b_185774) {

pluseq__185776(a_185771, "Field0", b_185774.Field0);
pluseq__185776(a_185771, "Field1", b_185774.Field1);
}
function star__185752(a_185757, s_185759) {

var result_185761 = {Field0: 0.0, Field1: 0.0};
result_185761.Field0 = (a_185757.Field0 * s_185759);
result_185761.Field1 = (a_185757.Field1 * s_185759);
return result_185761;
}
function new_185221() {

var result_185226 = null;
BeforeRet: do {
var r_185401 = null;
r_185401 = {m_type: NTI184087, size: 0, ttl: 0, pos: {Field0: 0, Field1: 0}, vel: {Field0: 0.0, Field1: 0.0}, rem: {Field0: 0.0, Field1: 0.0}, hitbox: {Field0: 0, Field1: 0, Field2: 0, Field3: 0}, shouldKill: false, bounciness: 0.0, ethereal: false, riding: null};
result_185226 = r_185401;
break BeforeRet;
} while (false); 
return result_185226;
}
function newGem_185211(x_185213, y_185214, xv_185215, yv_185216, size_185217) {

var result_185218 = null;
result_185218 = new_185221();
result_185218.size = size_185217;
result_185218.pos.Field0 = x_185213;
result_185218.pos.Field1 = y_185214;
result_185218.vel.Field0 = xv_185215;
result_185218.vel.Field1 = yv_185216;
result_185218.hitbox.Field0 = 2;
result_185218.hitbox.Field2 = 4;
result_185218.hitbox.Field1 = 3;
result_185218.hitbox.Field3 = 4;
result_185218.ttl = 300;
result_185218.bounciness = 7.5000000000000000e-001;
return result_185218;
}
function random_169318(max_169320) {

var result_169321 = 0.0;
var x_169323 = next_168841(state_168605[0]);
result_169321 = ((x_169323 / 4294967295) * max_169320);
return result_169321;
}
function rnd_177489(x_177491) {

var result_181642 = 0.0;
BeforeRet: do {
result_181642 = random_169318(x_177491);
break BeforeRet;
} while (false); 
return result_181642;
}
function collide_185804(a_185806, b_185807) {

var Tmp4;
a_185806.shouldKill = true;
if ((b_185807.hitflash == 0)) {
b_185807.hp -= a_185806.damage;
b_185807.hitflash = 4;
}

pluseq__185765(b_185807.vel, star__185752(a_185806.vel, 5.0000000000000000e-001));
if ((b_185807.hp < 0)) {
b_185807.shouldKill = true;
L1: do {
var i_185893 = 0;
var colontmp__185911 = 0;
colontmp__185911 = rnd_185630(4);
var res_185914 = 0;
L2: do {
L3: while (true) {
if (!(res_185914 <= colontmp__185911)) break L3;
i_185893 = res_185914;
if ((rnd_185630(10) == 0)) {
Tmp4 = 1;
}
else {
Tmp4 = 0;
}

if (objects_185415[0] != null) { objects_185415[0].push(newGem_185211(b_185807.pos.Field0, b_185807.pos.Field1, (rnd_177489(2.0000000000000000e+000) - 1.0000000000000000e+000), (rnd_177489(1.0000000000000000e+000) - 5.0000000000000000e-001), Tmp4)); } else { objects_185415[0] = [newGem_185211(b_185807.pos.Field0, b_185807.pos.Field1, (rnd_177489(2.0000000000000000e+000) - 1.0000000000000000e+000), (rnd_177489(1.0000000000000000e+000) - 5.0000000000000000e-001), Tmp4)]; };
res_185914 += 1;
}
} while(false);
} while(false);
}

}
function minus__185713(a_185718, b_185721) {

var result_185723 = {Field0: 0.0, Field1: 0.0};
result_185723.Field0 = (a_185718.Field0 - b_185721.Field0);
result_185723.Field1 = (a_185718.Field1 - b_185721.Field1);
return result_185723;
}
function vec2f_183051(v_183053) {

var result_183054 = {Field0: 0.0, Field1: 0.0};
result_183054.Field0 = v_183053.Field0;
result_183054.Field1 = v_183053.Field1;
return result_183054;
}
function collide_185624(a_185626, b_185627) {

var Tmp1;
var Tmp5;
if (!(0.0 < a_185626.vel.Field1)) Tmp1 = false; else {Tmp1 = ((a_185626.pos.Field1 + a_185626.hitbox.Field1) <= (b_185627.pos.Field1 + b_185627.hitbox.Field1)); }if (Tmp1) {
a_185626.vel.Field1 = -1.5000000000000000e+000;
b_185627.shouldKill = true;
a_185626.wasOnGround = true;
a_185626.ammo = 8;
L2: do {
var i_185647 = 0;
var colontmp__185797 = 0;
colontmp__185797 = rnd_185630(4);
var res_185800 = 0;
L3: do {
L4: while (true) {
if (!(res_185800 <= colontmp__185797)) break L4;
i_185647 = res_185800;
if ((rnd_185630(10) == 0)) {
Tmp5 = 1;
}
else {
Tmp5 = 0;
}

if (objects_185415[0] != null) { objects_185415[0].push(newGem_185211(b_185627.pos.Field0, b_185627.pos.Field1, (rnd_177489(2.0000000000000000e+000) - 1.0000000000000000e+000), (rnd_177489(1.0000000000000000e+000) - 5.0000000000000000e-001), Tmp5)); } else { objects_185415[0] = [newGem_185211(b_185627.pos.Field0, b_185627.pos.Field1, (rnd_177489(2.0000000000000000e+000) - 1.0000000000000000e+000), (rnd_177489(1.0000000000000000e+000) - 5.0000000000000000e-001), Tmp5)]; };
res_185800 += 1;
}
} while(false);
} while(false);
}
else {
if ((a_185626.hitflash == 0)) {
a_185626.hitflash = 30;
a_185626.hp -= 1;
pluseq__185765(a_185626.vel, star__185752(minus__185713(vec2f_183051(a_185626.pos), vec2f_183051(b_185627.pos)), 5.0000000000000000e-001));
if ((a_185626.hp < 1)) {
gameOver_184161[0] = true;
a_185626.shouldKill = true;
}

}

}

}
function collide_185922(a_185924, b_185925) {

var Tmp4;
b_185925.shouldKill = true;
if ((a_185924.hitflash == 0)) {
a_185924.hitflash = 4;
a_185924.hp -= b_185925.damage;
if ((a_185924.hp <= 0)) {
a_185924.shouldKill = true;
L1: do {
var i_185950 = 0;
var colontmp__185968 = 0;
colontmp__185968 = rnd_185630(10);
var res_185971 = 0;
L2: do {
L3: while (true) {
if (!(res_185971 <= colontmp__185968)) break L3;
i_185950 = res_185971;
if ((rnd_185630(10) == 0)) {
Tmp4 = 1;
}
else {
Tmp4 = 0;
}

if (objects_185415[0] != null) { objects_185415[0].push(newGem_185211(a_185924.pos.Field0, a_185924.pos.Field1, (rnd_177489(2.0000000000000000e+000) - 1.0000000000000000e+000), (rnd_177489(1.0000000000000000e+000) - 5.0000000000000000e-001), Tmp4)); } else { objects_185415[0] = [newGem_185211(a_185924.pos.Field0, a_185924.pos.Field1, (rnd_177489(2.0000000000000000e+000) - 1.0000000000000000e+000), (rnd_177489(1.0000000000000000e+000) - 5.0000000000000000e-001), Tmp4)]; };
res_185971 += 1;
}
} while(false);
} while(false);
}

}

}
function collide_185918(a_185920, b_185921) {

collide_185601(b_185921, a_185920);
}
function collide_186393(self_186395, other_186396) {

collide_185601(other_186396, self_186395);
}
function collide_185975(a_185977, b_185978) {

collide_185601(b_185978, a_185977);
}
function collide_185596(a_185598, b_185599) {

}
function collide_185601(a_185598, b_185599) {

chckNilDisp(a_185598);
chckNilDisp(b_185599);
if ((isObj(a_185598.m_type, NTI184091) & isObj(b_185599.m_type, NTI184091))) {
collide_185603(a_185598, b_185599);
}
else {
if ((isObj(a_185598.m_type, NTI184048) & isObj(b_185599.m_type, NTI184087))) {
collide_185611(a_185598, b_185599);
}
else {
if ((isObj(a_185598.m_type, NTI184087) & isObj(b_185599.m_type, NTI184087))) {
collide_185607(a_185598, b_185599);
}
else {
if ((isObj(a_185598.m_type, NTI184066) & isObj(b_185599.m_type, NTI184091))) {
collide_185804(a_185598, b_185599);
}
else {
if ((isObj(a_185598.m_type, NTI184048) & isObj(b_185599.m_type, NTI184091))) {
collide_185624(a_185598, b_185599);
}
else {
if ((isObj(a_185598.m_type, NTI184073) & isObj(b_185599.m_type, NTI184066))) {
collide_185922(a_185598, b_185599);
}
else {
if ((isObj(a_185598.m_type, NTI184091) & isObj(b_185599.m_type, NTI184066))) {
collide_185918(a_185598, b_185599);
}
else {
if ((isObj(a_185598.m_type, NTI184048) & isObj(b_185599.m_type, NTI184077))) {
collide_186393(a_185598, b_185599);
}
else {
if ((isObj(a_185598.m_type, NTI184066) & isObj(b_185599.m_type, NTI184073))) {
collide_185975(a_185598, b_185599);
}
else {
if ((isObj(a_185598.m_type, NTI184032) & isObj(b_185599.m_type, NTI184032))) {
collide_185596(a_185598, b_185599);
}
}}}}}}}}}
}
function length_186461(a_186466) {

var result_186467 = 0.0;
BeforeRet: do {
result_186467 = Math.sqrt(((a_186466.Field0 * a_186466.Field0) + (a_186466.Field1 * a_186466.Field1)));
break BeforeRet;
} while (false); 
return result_186467;
}
function plus__186612(a_186617, s_186619) {

var result_186621 = {Field0: 0.0, Field1: 0.0};
result_186621.Field0 = (a_186617.Field0 + s_186619);
result_186621.Field1 = (a_186617.Field1 + s_186619);
return result_186621;
}
function stareq__186694(x_186699, x_186699_Idx, y_186701) {

x_186699[x_186699_Idx] = (x_186699[x_186699_Idx] * y_186701);
}
function update_186397(self_186399) {

var Tmp1;
if ((self_186399.target == null)) {
var d_186468 = length_186461(minus__185713(vec2f_183051(self_186399.pos), vec2f_183051(player_184159[0].pos)));
if ((d_186468 < 3.2000000000000000e+001)) {
self_186399.target = player_184159[0];
}

}

if ((self_186399.target == null)) Tmp1 = true; else {Tmp1 = (rnd_185630(5) == 0); }if (Tmp1) {
pluseq__185776(self_186399.vel, "Field0", (rnd_177489(1.0000000000000001e-001) - 5.0000000000000003e-002));
pluseq__185776(self_186399.vel, "Field1", (rnd_177489(1.0000000000000001e-001) - 5.0000000000000003e-002));
}
else {
pluseq__185765(self_186399.vel, plus__186612(star__185752(minus__185713(vec2f_183051(player_184159[0].pos), vec2f_183051(self_186399.pos)), 5.0000000000000001e-003), rnd_177489(1.0000000000000000e-002)));
var d_186692 = length_186461(minus__185713(vec2f_183051(self_186399.pos), vec2f_183051(player_184159[0].pos)));
if ((6.4000000000000000e+001 < d_186692)) {
self_186399.target = null;
}

}

if ((2.5000000000000000e-001 < Math.abs(self_186399.vel.Field0))) {
stareq__186694(self_186399.vel, "Field0", 2.5000000000000000e-001);
}

if ((5.0000000000000000e-001 < Math.abs(self_186399.vel.Field1))) {
stareq__186694(self_186399.vel, "Field1", 5.0000000000000000e-001);
}

if ((0 < self_186399.hitflash)) {
self_186399.hitflash -= 1;
}

}
function update_186380(self_186382) {

var Tmp1;
var Tmp2;
var Tmp3;
var Tmp4;
var Tmp5;
if ((self_186382.direction == 0)) {
if ((rnd_185630(2) == 0)) {
Tmp1 = -1;
}
else {
Tmp1 = 1;
}

self_186382.direction = Tmp1;
}

if ((self_186382.vel.Field0 == 0.0)) Tmp3 = true; else {if (!(self_186382.vel.Field0 < 0.0)) Tmp4 = false; else {Tmp4 = (self_186382.pos.Field0 < 16); }Tmp3 = Tmp4; }if (Tmp3) Tmp2 = true; else {if (!(0.0 < self_186382.vel.Field0)) Tmp5 = false; else {Tmp5 = (104 < self_186382.pos.Field0); }Tmp2 = Tmp5; }if (Tmp2) {
self_186382.direction = -(self_186382.direction);
}

if ((self_186382.direction == -1)) {
self_186382.vel.Field0 = -1.0000000000000001e-001;
}
else {
if ((self_186382.direction == 1)) {
self_186382.vel.Field0 = 1.0000000000000001e-001;
}
}
}
function update_186368(self_186370) {

if ((0 < self_186370.hitflash)) {
self_186370.hitflash -= 1;
}

}
function axis_26021(self_26023, axis_26024) {

var result_26025 = 0.0;
BeforeRet: do {
result_26025 = self_26023.axes[axis_26024].Field0;
break BeforeRet;
} while (false); 
return result_26025;
}
function btn_26033(self_26035, button_26036) {

var Tmp1;
var Tmp2;
var Tmp3;
var Tmp4;
var result_26037 = false;
BeforeRet: do {
if ((button_26036 == 2)) {
if ((0 < self_26035.buttons[button_26036])) Tmp1 = true; else {Tmp1 = (axis_26021(self_26035, 0) < -(self_26035.deadzone)); }result_26037 = Tmp1;
break BeforeRet;
}
else {
if ((button_26036 == 3)) {
if ((0 < self_26035.buttons[button_26036])) Tmp2 = true; else {Tmp2 = (self_26035.deadzone < axis_26021(self_26035, 0)); }result_26037 = Tmp2;
break BeforeRet;
}
else {
if ((button_26036 == 0)) {
if ((0 < self_26035.buttons[button_26036])) Tmp3 = true; else {Tmp3 = (axis_26021(self_26035, 1) < -(self_26035.deadzone)); }result_26037 = Tmp3;
break BeforeRet;
}
else {
if ((button_26036 == 1)) {
if ((0 < self_26035.buttons[button_26036])) Tmp4 = true; else {Tmp4 = (self_26035.deadzone < axis_26021(self_26035, 1)); }result_26037 = Tmp4;
break BeforeRet;
}
}}}
result_26037 = (0 < self_26035.buttons[button_26036]);
break BeforeRet;
} while (false); 
return result_26037;
}
function btn_177277(b_177279) {

var result_177742 = false;
BeforeRet: do {
L1: do {
var c_177751 = null;
var i_177755 = 0;
var L_177757 = (controllers_33347[0] != null ? controllers_33347[0].length : 0);
L2: do {
L3: while (true) {
if (!(i_177755 < L_177757)) break L3;
c_177751 = controllers_33347[0][i_177755];
if (btn_26033(c_177751, b_177279)) {
result_177742 = true;
break BeforeRet;
}

i_177755 += 1;
}
} while(false);
} while(false);
result_177742 = false;
break BeforeRet;
} while (false); 
return result_177742;
}
function isTouchingType_185586(self_185588, ox_185589, oy_185590, check_185594) {

var result_185595 = false;
BeforeRet: do {
result_185595 = isTouchingType_185497(((self_185588.pos.Field0 + self_185588.hitbox.Field0) + ox_185589), ((self_185588.pos.Field1 + self_185588.hitbox.Field1) + oy_185590), self_185588.hitbox.Field2, self_185588.hitbox.Field3, check_185594);
break BeforeRet;
} while (false); 
return result_185595;
}
function isSpikes_185485(t_185487) {

var result_185488 = false;
BeforeRet: do {
result_185488 = (t_185487 == 5);
break BeforeRet;
} while (false); 
return result_185488;
}
function getNearObj_186889(self_186893, x_186897, y_186899) {

var Tmp4;
var result_186900 = null;
BeforeRet: do {
L1: do {
var o_186909 = null;
var i_186923 = 0;
var L_186925 = (objects_185415[0] != null ? objects_185415[0].length : 0);
L2: do {
L3: while (true) {
if (!(i_186923 < L_186925)) break L3;
o_186909 = objects_185415[0][i_186923];
if (!!((o_186909 == self_186893))) Tmp4 = false; else {Tmp4 = isObj(o_186909.m_type, NTI184077); }if (Tmp4) {
if (overlaps_185430(self_186893, o_186909, x_186897, y_186899)) {
result_186900 = o_186909;
break BeforeRet;
}

}

i_186923 += 1;
}
} while(false);
} while(false);
result_186900 = null;
break BeforeRet;
} while (false); 
return result_186900;
}
function appr_185445(val_185447, target_185448, amount_185449) {

var Tmp1;
var result_185450 = 0.0;
BeforeRet: do {
if ((target_185448 < val_185447)) {
Tmp1 = nimMax((val_185447 - amount_185449), target_185448);
}
else {
Tmp1 = nimMin((val_185447 + amount_185449), target_185448);
}

result_185450 = Tmp1;
break BeforeRet;
} while (false); 
return result_185450;
}
function stareq__54501(x_54506, x_54506_Idx, y_54508) {

x_54506[x_54506_Idx] = (x_54506[x_54506_Idx] * y_54508);
}
function new_185020() {

var result_185025 = null;
BeforeRet: do {
var r_185201 = null;
r_185201 = {m_type: NTI184084, ttl: 0, pos: {Field0: 0, Field1: 0}, vel: {Field0: 0.0, Field1: 0.0}, rem: {Field0: 0.0, Field1: 0.0}, hitbox: {Field0: 0, Field1: 0, Field2: 0, Field3: 0}, shouldKill: false, bounciness: 0.0, ethereal: false, riding: null};
result_185025 = r_185201;
break BeforeRet;
} while (false); 
return result_185025;
}
function newFart_185011(x_185013, y_185014, xv_185015, yv_185016) {

var result_185017 = null;
result_185017 = new_185020();
result_185017.pos.Field0 = x_185013;
result_185017.pos.Field1 = y_185014;
result_185017.vel.Field0 = xv_185015;
result_185017.vel.Field1 = yv_185016;
result_185017.hitbox.Field0 = 2;
result_185017.hitbox.Field2 = 4;
result_185017.hitbox.Field1 = 3;
result_185017.hitbox.Field3 = 4;
result_185017.ttl = 4;
return result_185017;
}
function new_184820() {

var result_184825 = null;
BeforeRet: do {
var r_185001 = null;
r_185001 = {m_type: NTI184066, damage: 0, destructive: false, ttl: 0, pos: {Field0: 0, Field1: 0}, vel: {Field0: 0.0, Field1: 0.0}, rem: {Field0: 0.0, Field1: 0.0}, hitbox: {Field0: 0, Field1: 0, Field2: 0, Field3: 0}, shouldKill: false, bounciness: 0.0, ethereal: false, riding: null};
result_184825 = r_185001;
break BeforeRet;
} while (false); 
return result_184825;
}
function newBullet_184811(x_184813, y_184814, xv_184815, yv_184816) {

var result_184817 = null;
result_184817 = new_184820();
result_184817.damage = 1;
result_184817.pos.Field0 = x_184813;
result_184817.pos.Field1 = y_184814;
result_184817.vel.Field0 = xv_184815;
result_184817.vel.Field1 = yv_184816;
result_184817.hitbox.Field0 = 2;
result_184817.hitbox.Field2 = 4;
result_184817.hitbox.Field1 = 3;
result_184817.hitbox.Field3 = 4;
result_184817.ttl = 30;
return result_184817;
}
function transform_186856(self_186858) {

self_186858.mode = 1;
self_186858.hitbox.Field0 = 2;
self_186858.hitbox.Field2 = 12;
self_186858.hitbox.Field1 = 6;
self_186858.hitbox.Field3 = 8;
}
function update_186859(self_186861) {

var Tmp1;
var Tmp2;
var Tmp3;
var Tmp4;
var Tmp5;
var Tmp6;
var Tmp7;
var Tmp8;
var Tmp9;
var Tmp10;
var Tmp11;
var Tmp12;
var Tmp16;
var Tmp17;
switch (self_186861.mode) {
case 0: if (btn_177277(3)) {
Tmp1 = 1;
}
else {
if (btn_177277(2)) {
Tmp1 = -1;
}
else {
Tmp1 = 0;
}
}
var input_186862 = Tmp1;
if ((input_186862 < 0)) {
self_186861.dir = 0;
}
else {
if ((0 < input_186862)) {
self_186861.dir = 1;
}
}
if (isSolid_185581(self_186861, 0, 1)) Tmp2 = true; else {Tmp2 = check_186016(self_186861, 0, 1); }var onGround_186876 = Tmp2;
if (isTouchingType_185586(self_186861, 0, 0, isSpikes_185485)) {
if ((self_186861.hitflash == 0)) {
self_186861.hp -= 1;
self_186861.hitflash = 30;
self_186861.vel.Field1 = -2.0000000000000000e+000;
}

}

var o_186926 = getNearObj_186889(self_186861, 0, 1);
if ((o_186926 == null)) {
o_186926 = getNearObj_186889(self_186861, 1, 0);
}

if ((o_186926 == null)) {
o_186926 = getNearObj_186889(self_186861, -1, 0);
}

if (!((o_186926 == null))) {
self_186861.riding = o_186926;
}
else {
self_186861.riding = null;
}

if (!btn_177277(4)) Tmp3 = false; else {Tmp3 = !(self_186861.jump); }var jump_186986 = Tmp3;
self_186861.jump = btn_177277(4);
if (jump_186986) {
self_186861.jbuffer = 8;
}
else {
if ((0 < self_186861.jbuffer)) {
self_186861.jbuffer -= 1;
}
}
if ((0 < self_186861.hitflash)) {
self_186861.hitflash -= 1;
}

var maxrun_187005 = 1.0000000000000000e+000;
var accel_187006 = 5.9999999999999998e-001;
var deccel_187007 = 1.4999999999999999e-001;
if (!(onGround_186876)) {
accel_187006 = 4.0000000000000002e-001;
}

if (onGround_186876) {
self_186861.grace = 12;
}

if ((0 < self_186861.grace)) {
self_186861.grace -= 1;
}

if ((maxrun_187005 < Math.abs(self_186861.vel.Field0))) {
self_186861.vel.Field0 = appr_185445(self_186861.vel.Field0, (input_186862 * maxrun_187005), deccel_187007);
}
else {
self_186861.vel.Field0 = appr_185445(self_186861.vel.Field0, (input_186862 * maxrun_187005), accel_187006);
}

if (btn_177277(1)) {
Tmp4 = 2.0000000000000000e+000;
}
else {
Tmp4 = 1.5000000000000000e+000;
}

var maxfall_187017 = Tmp4;
if (btn_177277(1)) {
Tmp5 = 2.0999999999999999e-001;
}
else {
Tmp5 = 1.0500000000000000e-001;
}

var gravity_187018 = /**/[Tmp5];
if ((Math.abs(self_186861.vel.Field1) <= 1.4999999999999999e-001)) {
stareq__54501(gravity_187018, 0, 5.0000000000000000e-001);
}

if (!!((input_186862 == 0))) Tmp6 = false; else {if (isSolid_185581(self_186861, input_186862, 0)) Tmp7 = true; else {Tmp7 = check_186016(self_186861, input_186862, 0); }Tmp6 = Tmp7; }if (Tmp6) {
maxfall_187017 = 4.0000000000000002e-001;
self_186861.wasOnWall = true;
}
else {
self_186861.wasOnWall = false;
}

if (!(onGround_186876)) {
self_186861.vel.Field1 = appr_185445(self_186861.vel.Field1, maxfall_187017, gravity_187018[0]);
}

if ((0 < self_186861.jbuffer)) {
if ((0 < self_186861.grace)) {
self_186861.jbuffer = 0;
minuseq__186332(self_186861.vel, "Field1", 2.0000000000000000e+000);
}
else {
if (!self_186861.wasOnWall) Tmp8 = false; else {Tmp8 = !((input_186862 == 0)); }if (Tmp8) {
self_186861.jbuffer = 0;
self_186861.vel.Field1 = -2.0000000000000000e+000;
self_186861.vel.Field0 = (-(input_186862) * (maxrun_187005 + 1.0000000000000001e-001));
}

}

}

self_186861.wasOnGround = onGround_186876;
if (self_186861.wasOnGround) {
self_186861.ammo = 8;
}

var tx_187053 = Math.floor((self_186861.pos.Field0 + 4) / 8);
var ty_187054 = Math.floor((self_186861.pos.Field1 + 4) / 8);
if ((mget_177445(toPint_33305(tx_187053), toPint_33305(ty_187054)) == 33)) {
mset_177440(toPint_33305(tx_187053), toPint_33305(ty_187054), 0);
}

if (!btnp_177280(4)) Tmp10 = false; else {Tmp10 = !(self_186861.wasOnGround); }if (!Tmp10) Tmp9 = false; else {Tmp9 = !(self_186861.wasOnWall); }if (Tmp9) {
self_186861.firing = true;
}

if (!btn_177277(4)) Tmp12 = false; else {Tmp12 = self_186861.firing; }if (!Tmp12) Tmp11 = false; else {Tmp11 = (self_186861.bulletTimer <= 0); }if (Tmp11) {
if ((self_186861.ammo <= 0)) {
var fart_187063 = newFart_185011(self_186861.pos.Field0, ((toPint_33305(self_186861.pos.Field1) + toPint_33295(8.0000000000000000e+000))|0), 0.0, 2.0000000000000000e+000);
if (objects_185415[0] != null) { objects_185415[0].push(fart_187063); } else { objects_185415[0] = [fart_187063]; };
self_186861.bulletTimer = 16;
}
else {
switch (self_186861.weapon) {
case 0: var bullet_187074 = newBullet_184811(self_186861.pos.Field0, ((toPint_33305(self_186861.pos.Field1) + toPint_33295(4.0000000000000000e+000))|0), 0.0, 4.0000000000000000e+000);
if (objects_185415[0] != null) { objects_185415[0].push(bullet_187074); } else { objects_185415[0] = [bullet_187074]; };
self_186861.bulletTimer = 8;
self_186861.ammo -= 1;
minuseq__186332(self_186861.vel, "Field1", 1.0000000000000001e-001);

break;
case 1: L13: do {
var i_187113 = 0;
var res_187214 = 0;
L14: do {
L15: while (true) {
if (!(res_187214 <= 5)) break L15;
i_187113 = res_187214;
var bullet_187114 = newBullet_184811(self_186861.pos.Field0, ((toPint_33305(self_186861.pos.Field1) + toPint_33295(4.0000000000000000e+000))|0), (rnd_177489(2.0000000000000000e+000) - 1.0000000000000000e+000), 4.0000000000000000e+000);
if (objects_185415[0] != null) { objects_185415[0].push(bullet_187114); } else { objects_185415[0] = [bullet_187114]; };
minuseq__186332(self_186861.vel, "Field1", 2.0000000000000001e-001);
res_187214 += 1;
}
} while(false);
} while(false);
self_186861.ammo -= 2;
self_186861.bulletTimer = 16;

break;
default: 
break;
}
}

}

if (!(btn_177277(4))) {
self_186861.firing = false;
}
else {
if ((0 < self_186861.bulletTimer)) {
self_186861.bulletTimer -= 1;
}
}
if ((2176 < self_186861.pos.Field1)) {
transform_186856(self_186861);
}


break;
case 1: self_186861.vel.Field1 = appr_185445(self_186861.vel.Field1, -2.0000000000000000e+000, 1.0000000000000000e-002);
if (btn_177277(3)) {
Tmp16 = 1.0000000000000000e+000;
}
else {
if (btn_177277(2)) {
Tmp16 = -1.0000000000000000e+000;
}
else {
Tmp16 = 0.0;
}
}
var input_187159 = Tmp16;
pluseq__185776(self_186861.vel, "Field0", (input_187159 * 1.0000000000000001e-001));
stareq__186694(self_186861.vel, "Field0", 9.7999999999999998e-001);
if (!btn_177277(4)) Tmp17 = false; else {Tmp17 = (self_186861.bulletTimer == 0); }if (Tmp17) {
var bullet_187181 = newBullet_184811((self_186861.pos.Field0 + 4), self_186861.pos.Field1, (rnd_177489(1.0000000000000000e+000) - 5.0000000000000000e-001), -4.0000000000000000e+000);
bullet_187181.destructive = true;
bullet_187181.ttl = 60;
if (objects_185415[0] != null) { objects_185415[0].push(bullet_187181); } else { objects_185415[0] = [bullet_187181]; };
self_186861.bulletTimer = 4;
}
else {
if ((0 < self_186861.bulletTimer)) {
self_186861.bulletTimer -= 1;
}
}

break;
}
}
function update_186767(self_186769) {

self_186769.ttl -= 1;
if ((self_186769.ttl < 0)) {
self_186769.shouldKill = true;
}

self_186769.vel.Field1 = appr_185445(self_186769.vel.Field1, 5.0000000000000000e-001, 1.0500000000000000e-001);
self_186769.vel.Field0 = appr_185445(self_186769.vel.Field0, 0.0, 1.0000000000000000e-003);
var d_186819 = minus__185713(vec2f_183051(self_186769.pos), vec2f_183051(player_184159[0].pos));
if ((length_186461(d_186819) < 1.6000000000000000e+001)) {
minuseq__186332(self_186769.vel, "Field0", ((d_186819.Field0 * 1.0000000000000000e-002) + (1.0000000000000001e-001 * self_186769.vel.Field0)));
minuseq__186332(self_186769.vel, "Field1", ((d_186819.Field1 * 1.0000000000000000e-002) + (1.0000000000000001e-001 * self_186769.vel.Field0)));
}

}
function update_186755(self_186757) {

var Tmp1;
self_186757.ttl -= 1;
if ((self_186757.ttl < 0)) Tmp1 = true; else {Tmp1 = (self_186757.vel.Field1 == 0.0); }if (Tmp1) {
self_186757.shouldKill = true;
}

}
function update_186722(self_186724) {

var Tmp1;
if (self_186724.destructive) {
var x_186725 = Math.floor(self_186724.pos.Field0 / 8);
var y_186726 = Math.floor((self_186724.pos.Field1 - 1) / 8);
var t_186727 = mget_177445(toPint_33305(x_186725), toPint_33305(y_186726));
if ((16 <= t_186727)) {
mset_177440(toPint_33305(x_186725), toPint_33305(y_186726), 0);
}

}

self_186724.ttl -= 1;
if (!(self_186724.vel.Field1 == 0.0)) Tmp1 = false; else {Tmp1 = (4 < self_186724.ttl); }if (Tmp1) {
self_186724.ttl = 4;
}

if ((self_186724.ttl < 0)) {
self_186724.shouldKill = true;
}

if (!(self_186724.destructive)) {
stareq__186694(self_186724.vel, "Field1", 9.4999999999999996e-001);
}

}
function update_186362(self_186364) {

}
function update_186366(self_186364) {

chckNilDisp(self_186364);
if (isObj(self_186364.m_type, NTI184091)) {
update_186397(self_186364);
}
else {
if (isObj(self_186364.m_type, NTI184077)) {
update_186380(self_186364);
}
else {
if (isObj(self_186364.m_type, NTI184073)) {
update_186368(self_186364);
}
else {
if (isObj(self_186364.m_type, NTI184048)) {
update_186859(self_186364);
}
else {
if (isObj(self_186364.m_type, NTI184087)) {
update_186767(self_186364);
}
else {
if (isObj(self_186364.m_type, NTI184084)) {
update_186755(self_186364);
}
else {
if (isObj(self_186364.m_type, NTI184066)) {
update_186722(self_186364);
}
else {
if (isObj(self_186364.m_type, NTI184032)) {
update_186362(self_186364);
}
}}}}}}}
}
function blitFastFlip_179301(src_179303, sx_179304, sy_179305, dx_179306, dy_179307, w_179308, h_179309, hflip_179310, vflip_179311) {

var Tmp1;
var Tmp2;
var Tmp3;
var Tmp4;
var Tmp8;
var Tmp9;
var Tmp10;
var Tmp14;
var Tmp15;
var Tmp16;
if (hflip_179310) {
Tmp1 = (w_179308 - 1);
}
else {
Tmp1 = 0;
}

var startsx_179312 = (sx_179304 + Tmp1);
var sxi_179313 = startsx_179312;
if (vflip_179311) {
Tmp2 = (h_179309 - 1);
}
else {
Tmp2 = 0;
}

var syi_179314 = (sy_179305 + Tmp2);
var dxi_179315 = dx_179306;
var dyi_179316 = dy_179307;
if (hflip_179310) {
Tmp3 = -1;
}
else {
Tmp3 = 1;
}

var xi_179317 = Tmp3;
if (vflip_179311) {
Tmp4 = -1;
}
else {
Tmp4 = 1;
}

var yi_179318 = Tmp4;
L5: do {
L6: while (true) {
if (!(dyi_179316 < (dy_179307 + h_179309))) break L6;
L7: do {
if ((syi_179314 < 0)) Tmp10 = true; else {Tmp10 = ((src_179303.h - 1) < (syi_179314|0)); }if (Tmp10) Tmp9 = true; else {Tmp9 = ((dyi_179316|0) < clipMinY_33467[0]); }if (Tmp9) Tmp8 = true; else {Tmp8 = (clipMaxY_33468[0] < (dyi_179316|0)); }if (Tmp8) {
syi_179314 += toPint_33305(yi_179318);
dyi_179316 += 1;
sxi_179313 = startsx_179312;
dxi_179315 = dx_179306;
break L7;
}

L11: do {
L12: while (true) {
if (!(dxi_179315 < (dx_179306 + w_179308))) break L12;
L13: do {
if ((sxi_179313 < 0)) Tmp16 = true; else {Tmp16 = ((src_179303.w - 1) < (sxi_179313|0)); }if (Tmp16) Tmp15 = true; else {Tmp15 = ((dxi_179315|0) < clipMinX_33465[0]); }if (Tmp15) Tmp14 = true; else {Tmp14 = (clipMaxX_33466[0] < (dxi_179315|0)); }if (Tmp14) {
dxi_179315 += 1;
sxi_179313 += toPint_33305(xi_179317);
break L13;
}

var srcCol_179355 = src_179303.data[(((syi_179314|0) * src_179303.w) + (sxi_179313|0))];
if (!(paletteTransparent_33440[0][srcCol_179355])) {
swCanvas_33316[0].data[(((dyi_179316|0) * swCanvas_33316[0].w) + (dxi_179315|0))] = paletteMapDraw_33430[0][srcCol_179355];
}

sxi_179313 += toPint_33305(xi_179317);
dxi_179315 += 1;
} while(false);
}
} while(false);
syi_179314 += toPint_33305(yi_179318);
dyi_179316 += 1;
sxi_179313 = startsx_179312;
dxi_179315 = dx_179306;
} while(false);
}
} while(false);
}
function spr_177390(spr_177394, x_177395, y_177396, w_177397, h_177398, hflip_177399, vflip_177400) {

var src_181136 = getSprRect_181105(spr_177394, w_177397, h_177398);
var dst_181138 = nimCopy(null, {Field0: ((x_177395 - cameraX_33420[0])|0), Field1: ((y_177396 - cameraY_33422[0])|0), Field2: src_181136.Field2, Field3: src_181136.Field3}, NTI33206);
if ((hflip_177399 || vflip_177400)) {
blitFastFlip_179301(spriteSheet_33378[0], toPint_33305(src_181136.Field0), toPint_33305(src_181136.Field1), (x_177395 - cameraX_33420[0]), (y_177396 - cameraY_33422[0]), toPint_33305(src_181136.Field2), toPint_33305(src_181136.Field3), hflip_177399, vflip_177400);
}
else {
blitFast_179211(spriteSheet_33378[0], toPint_33305(src_181136.Field0), toPint_33305(src_181136.Field1), (x_177395 - cameraX_33420[0]), (y_177396 - cameraY_33422[0]), toPint_33305(src_181136.Field2), toPint_33305(src_181136.Field3));
}

}
function draw_187234(self_187236) {

spr_177390(37, toPint_33305(self_187236.pos.Field0), toPint_33305(self_187236.pos.Field1), 1, 1, false, false);
}
function draw_187231(self_187233) {

var Tmp1;
if ((self_187233.ttl == 0)) Tmp1 = true; else {Tmp1 = isSolid_185581(self_187233, 0, 1); }if (Tmp1) {
spr_177390(36, toPint_33305(self_187233.pos.Field0), toPint_33305(self_187233.pos.Field1), 1, 1, false, false);
}
else {
spr_177390(35, toPint_33305(self_187233.pos.Field0), toPint_33305(self_187233.pos.Field1), 1, 1, false, false);
}

}
function pal_177250(a_177252, b_177253) {

paletteMapDraw_33430[0][a_177252] = b_177253;
}
function pal_177254() {

L1: do {
var i_177857 = 0;
var colontmp__177860 = 0;
colontmp__177860 = paletteSize_33425[0];
var i_177863 = 0;
L2: do {
L3: while (true) {
if (!(i_177863 < colontmp__177860)) break L3;
i_177857 = i_177863;
paletteMapDraw_33430[0][i_177857] = i_177857;
i_177863 += 1;
}
} while(false);
} while(false);
}
function draw_187224(self_187226) {

var Tmp1;
var Tmp2;
var Tmp3;
var Tmp4;
var Tmp5;
var Tmp6;
var Tmp7;
switch (self_187226.mode) {
case 0: if (!(1.0000000000000000e+000 < Math.abs(self_187226.vel.Field0))) Tmp2 = false; else {Tmp2 = (Math.floor(frame_184001[0] % 10) < 5); }if (Tmp2) {
Tmp1 = 4;
}
else {
if (!(self_187226.dir == 0)) Tmp4 = false; else {Tmp4 = isSolid_185581(self_187226, -3, 0); }if (Tmp4) Tmp3 = true; else {if (!(0 < self_187226.dir)) Tmp5 = false; else {Tmp5 = isSolid_185581(self_187226, 3, 0); }Tmp3 = Tmp5; }if (Tmp3) {
if (self_187226.wasOnGround) {
Tmp6 = 1;
}
else {
Tmp6 = 2;
}

Tmp1 = Tmp6;
}
else {
Tmp1 = 0;
}
}
var s_187229 = Tmp1;
if (!(0 < self_187226.hitflash)) Tmp7 = false; else {Tmp7 = (Math.floor(frame_184001[0] % 10) < 5); }if (Tmp7) {
pal_177250(1, 0);
pal_177250(2, 0);
}

spr_177390(s_187229, toPint_33305(self_187226.pos.Field0), toPint_33305(self_187226.pos.Field1), 1, 1, (self_187226.dir == 1), false);
pal_177254();

break;
case 1: spr_177390(64, toPint_33305(self_187226.pos.Field0), toPint_33305(self_187226.pos.Field1), 2, 2, false, false);

break;
}
}
function draw_187258(self_187260) {

spr_177390(30, toPint_33305(self_187260.pos.Field0), toPint_33305(self_187260.pos.Field1), 1, 1, false, false);
}
function draw_187254(self_187256) {

var Tmp1;
if (!(0 < self_187256.hitflash)) Tmp1 = false; else {Tmp1 = (Math.floor(frame_184001[0] % 10) < 5); }if (Tmp1) {
pal_177250(1, 3);
}

spr_177390(28, toPint_33305(self_187256.pos.Field0), toPint_33305(self_187256.pos.Field1), 1, 1, false, false);
pal_177250(1, 1);
}
function draw_187246(self_187248) {

var Tmp1;
if (!(0 < self_187248.hitflash)) Tmp1 = false; else {Tmp1 = (Math.floor(frame_184001[0] % 10) < 5); }if (Tmp1) {
pal_177250(2, 3);
}

spr_177390((48 + Math.floor(((frame_184001[0] / 3.0000000000000000e+001)|0) % 4)), toPint_33305(self_187248.pos.Field0), toPint_33305(self_187248.pos.Field1), 1, 1, false, false);
pal_177250(2, 2);
}
function draw_187237(self_187239) {

var Tmp1;
BeforeRet: do {
if (!(self_187239.ttl < 60)) Tmp1 = false; else {Tmp1 = (Math.floor(frame_184001[0] % 10) < 5); }if (Tmp1) {
break BeforeRet;
}

if ((Math.floor(frame_184001[0] % 10) < 5)) {
pal_177250(1, 3);
}

if ((self_187239.size == 0)) {
if ((Math.floor(frame_184001[0] % 30) < 15)) {
spr_177390(33, toPint_33305(self_187239.pos.Field0), toPint_33305(self_187239.pos.Field1), 1, 1, false, false);
}
else {
spr_177390(34, toPint_33305(self_187239.pos.Field0), toPint_33305(self_187239.pos.Field1), 1, 1, false, false);
}

}
else {
var t_187245 = Math.floor(frame_184001[0] % 60);
if ((t_187245 < 30)) {
spr_177390(39, toPint_33305(self_187239.pos.Field0), toPint_33305(self_187239.pos.Field1), 1, 1, false, false);
}
else {
spr_177390(40, toPint_33305(self_187239.pos.Field0), toPint_33305(self_187239.pos.Field1), 1, 1, false, false);
}

}

pal_177254();
} while (false); 
}
function hline_177362(x0_177364, y_177365, x1_177366) {

var x0_178496 = x0_177364;
var x1_178497 = x1_177366;
if ((x1_178497 < x0_178496)) {
var Tmp1 = x1_178497; x1_178497 = x0_178496; x0_178496 = Tmp1;}

L2: do {
var x_178517 = 0;
var res_178521 = (x0_178496|0);
L3: do {
L4: while (true) {
if (!(res_178521 <= (x1_178497|0))) break L4;
x_178517 = res_178521;
pset_177327(x_178517, y_177365);
res_178521 += 1;
}
} while(false);
} while(false);
}
function vline_177367(x_177369, y0_177370, y1_177371) {

var y0_178530 = y0_177370;
var y1_178531 = y1_177371;
if ((y1_178531 < y0_178530)) {
var Tmp1 = y1_178531; y1_178531 = y0_178530; y0_178530 = Tmp1;}

L2: do {
var y_178551 = 0;
var res_178555 = (y0_178530|0);
L3: do {
L4: while (true) {
if (!(res_178555 <= (y1_178531|0))) break L4;
y_178551 = res_178555;
pset_177327(x_177369, y_178551);
res_178555 += 1;
}
} while(false);
} while(false);
}
function rect_177350(x1_177352, y1_177353, x2_177354, y2_177355) {

var w_178565 = (x2_177354 - x1_177352);
var h_178566 = (y2_177355 - y1_177353);
var x_178567 = x1_177352;
var y_178568 = y1_177353;
hline_177362(x_178567, y_178568, (x_178567 + w_178565));
hline_177362(x_178567, (y_178568 + h_178566), (x_178567 + w_178565));
vline_177367((x_178567 + w_178565), (y_178568 + 1), ((y_178568 + h_178566) - 1));
vline_177367(x_178567, (y_178568 + 1), ((y_178568 + h_178566) - 1));
}
function draw_187218(self_187220) {

setColor_177238(2);
rect_177350(toPint_33305((self_187220.pos.Field0 + self_187220.hitbox.Field0)), toPint_33305((self_187220.pos.Field1 + self_187220.hitbox.Field1)), toPint_33305((((self_187220.pos.Field0 + self_187220.hitbox.Field0) + self_187220.hitbox.Field2) - 1)), toPint_33305((((self_187220.pos.Field1 + self_187220.hitbox.Field1) + self_187220.hitbox.Field3) - 1)));
}
function draw_187222(self_187220) {

chckNilDisp(self_187220);
if (isObj(self_187220.m_type, NTI184084)) {
draw_187234(self_187220);
}
else {
if (isObj(self_187220.m_type, NTI184066)) {
draw_187231(self_187220);
}
else {
if (isObj(self_187220.m_type, NTI184048)) {
draw_187224(self_187220);
}
else {
if (isObj(self_187220.m_type, NTI184077)) {
draw_187258(self_187220);
}
else {
if (isObj(self_187220.m_type, NTI184073)) {
draw_187254(self_187220);
}
else {
if (isObj(self_187220.m_type, NTI184091)) {
draw_187246(self_187220);
}
else {
if (isObj(self_187220.m_type, NTI184087)) {
draw_187237(self_187220);
}
else {
if (isObj(self_187220.m_type, NTI184032)) {
draw_187218(self_187220);
}
}}}}}}}
}
